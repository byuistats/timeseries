<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BYU-Idaho Time Series - Sample Statistics and Correlation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/TSFavicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/TSfavicon_inv.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BYU-Idaho Time Series</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Table of Contents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resource_blog.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-1" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-1">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_1.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_1_lesson_1.html">
 <span class="dropdown-text">Course Introduction</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_1_lesson_2.html">
 <span class="dropdown-text">Plots Trends, and Seasonal Variation</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="../chapter_1_lesson_3.html">
 <span class="dropdown-text">Averages for Time Series</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="../chapter_1_lesson_4.html">
 <span class="dropdown-text">Additive Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="../chapter_1_lesson_5.html">
 <span class="dropdown-text">Multiplicative Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-2">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_2.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_2_lesson_1.html">
 <span class="dropdown-text">Covariance and Correlation</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_2_lesson_2.html">
 <span class="dropdown-text">Autocorrelation Concepts</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="../chapter_2_lesson_3.html">
 <span class="dropdown-text">Exploration of Autocorrelation Concepts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-3" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-3">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_3.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_3_lesson_1.html">
 <span class="dropdown-text">Leading Variables and Associated Variables</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_3_lesson_2.html">
 <span class="dropdown-text">Exponential Smoothing (EWMA)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="../chapter_3_lesson_3.html">
 <span class="dropdown-text">Holt-Winters Method (Additive Models) - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="../chapter_3_lesson_4.html">
 <span class="dropdown-text">Holt-Winters Method (Additive Models) - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="../chapter_3_lesson_5.html">
 <span class="dropdown-text">Holt-Winters Method (Multiplicative Models)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-4" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-4">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_4.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_4_lesson_1.html">
 <span class="dropdown-text">White Noise and Random Walks - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_4_lesson_2.html">
 <span class="dropdown-text">White Noise and Random Walks - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="../chapter_4_lesson_3.html">
 <span class="dropdown-text">Autoregressive (AR) Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="../chapter_4_lesson_4.html">
 <span class="dropdown-text">Fitted AR Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-5" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 5</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-5">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_5.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_5_lesson_1.html">
 <span class="dropdown-text">Linear Models, GLS, and Seasonal Indicator Variables</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_5_lesson_2.html">
 <span class="dropdown-text">Harmonic Seasonal Variables - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="../chapter_5_lesson_3.html">
 <span class="dropdown-text">Harmonic Seasonal Variables - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="../chapter_5_lesson_4.html">
 <span class="dropdown-text">Transformations and Non-Linear Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="../chapter_5_lesson_5.html">
 <span class="dropdown-text">Forecasting, Inverse Transformation, and Bias Correction</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-6" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 6</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-6">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_6.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_6_lesson_1.html">
 <span class="dropdown-text">Moving Average (MA) Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_6_lesson_2.html">
 <span class="dropdown-text">Autoregressive Moving Average (ARMA) Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-7" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 7</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-7">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="../chapter_7.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="../chapter_7_lesson_1.html">
 <span class="dropdown-text">Introduction to Non-stationary Models and Differencing</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_7_lesson_2.html">
 <span class="dropdown-text">Seasonal ARIMA Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="../chapter_7_lesson_3.html">
 <span class="dropdown-text">ARCH and GARCH Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-new-sequence" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">New Sequence</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-new-sequence">    
        <li class="dropdown-header">Chapter 1</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_1_New.html">
 <span class="dropdown-text">Time Series Components</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 2</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_2_New.qmd">
 <span class="dropdown-text"></span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 3</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_3_New.html">
 <span class="dropdown-text">Time Series Components</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 4</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_4_New.html">
 <span class="dropdown-text">Trends</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 5</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_5_New.html">
 <span class="dropdown-text">Seasonality</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 6</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_6_New.html">
 <span class="dropdown-text">Stationary Stochastic Processes</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Chapter 7</li>
        <li>
    <a class="dropdown-item" href="../NewSequence/Chapter_7_New.html">
 <span class="dropdown-text">Non Stationary Stochastic Processes</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#functions-stuff" id="toc-functions-stuff" class="nav-link active" data-scroll-target="#functions-stuff"><span class="header-section-number">1.1</span> Functions &amp; Stuff</a></li>
  <li><a href="#chapter-2" id="toc-chapter-2" class="nav-link" data-scroll-target="#chapter-2"><span class="header-section-number">2</span> Chapter 2</a>
  <ul class="collapse">
  <li><a href="#motivate-the-chapter.-why-does-it-matter" id="toc-motivate-the-chapter.-why-does-it-matter" class="nav-link" data-scroll-target="#motivate-the-chapter.-why-does-it-matter"><span class="header-section-number">2.1</span> Motivate the chapter. Why does it matter?</a>
  <ul class="collapse">
  <li><a href="#connect-this-with-ch1.1" id="toc-connect-this-with-ch1.1" class="nav-link" data-scroll-target="#connect-this-with-ch1.1"><span class="header-section-number">2.1.1</span> Connect this with Ch1.1</a></li>
  </ul></li>
  <li><a href="#differentiate-population-and-sample-properties-and-statistics" id="toc-differentiate-population-and-sample-properties-and-statistics" class="nav-link" data-scroll-target="#differentiate-population-and-sample-properties-and-statistics"><span class="header-section-number">2.2</span> Differentiate population and sample properties and statistics</a></li>
  <li><a href="#contrast-parameters-and-statistics-estimators-and-estimates" id="toc-contrast-parameters-and-statistics-estimators-and-estimates" class="nav-link" data-scroll-target="#contrast-parameters-and-statistics-estimators-and-estimates"><span class="header-section-number">2.3</span> Contrast parameters and statistics, estimators and estimates</a>
  <ul class="collapse">
  <li><a href="#estimators-and-estimates" id="toc-estimators-and-estimates" class="nav-link" data-scroll-target="#estimators-and-estimates"><span class="header-section-number">2.3.1</span> Estimators and Estimates</a></li>
  <li><a href="#probabililty-distributions-of-a-population-and-the-sampling-distribution-of-estimators." id="toc-probabililty-distributions-of-a-population-and-the-sampling-distribution-of-estimators." class="nav-link" data-scroll-target="#probabililty-distributions-of-a-population-and-the-sampling-distribution-of-estimators."><span class="header-section-number">2.3.2</span> Probabililty distributions of a Population and the Sampling Distribution of Estimators.</a></li>
  </ul></li>
  <li><a href="#calculate-a-sample-standard-deviation" id="toc-calculate-a-sample-standard-deviation" class="nav-link" data-scroll-target="#calculate-a-sample-standard-deviation"><span class="header-section-number">2.4</span> Calculate a sample standard deviation</a>
  <ul class="collapse">
  <li><a href="#understanding-and-calculating-the-sample-standard-deviation" id="toc-understanding-and-calculating-the-sample-standard-deviation" class="nav-link" data-scroll-target="#understanding-and-calculating-the-sample-standard-deviation"><span class="header-section-number">2.4.1</span> Understanding and Calculating the Sample Standard Deviation</a></li>
  </ul></li>
  <li><a href="#calculate-sample-covariance-and-correlation-coefficient." id="toc-calculate-sample-covariance-and-correlation-coefficient." class="nav-link" data-scroll-target="#calculate-sample-covariance-and-correlation-coefficient."><span class="header-section-number">2.5</span> Calculate sample covariance and correlation coefficient.</a>
  <ul class="collapse">
  <li><a href="#understanding-covariance-and-correlation" id="toc-understanding-covariance-and-correlation" class="nav-link" data-scroll-target="#understanding-covariance-and-correlation"><span class="header-section-number">2.5.1</span> Understanding Covariance and Correlation</a></li>
  <li><a href="#explain-the-intuition-of-covariance-using-a-scatter-plot" id="toc-explain-the-intuition-of-covariance-using-a-scatter-plot" class="nav-link" data-scroll-target="#explain-the-intuition-of-covariance-using-a-scatter-plot"><span class="header-section-number">2.5.2</span> Explain the intuition of covariance using a scatter plot</a></li>
  </ul></li>
  <li><a href="#calculate-a-sample-autocorrelation" id="toc-calculate-a-sample-autocorrelation" class="nav-link" data-scroll-target="#calculate-a-sample-autocorrelation"><span class="header-section-number">2.6</span> Calculate a sample autocorrelation</a>
  <ul class="collapse">
  <li><a href="#autocovariance-and-autocorrelation" id="toc-autocovariance-and-autocorrelation" class="nav-link" data-scroll-target="#autocovariance-and-autocorrelation"><span class="header-section-number">2.6.1</span> Autocovariance and Autocorrelation</a></li>
  <li><a href="#define-population-and-sample-autocorrelation" id="toc-define-population-and-sample-autocorrelation" class="nav-link" data-scroll-target="#define-population-and-sample-autocorrelation"><span class="header-section-number">2.6.2</span> Define population and sample autocorrelation</a></li>
  <li><a href="#explain-the-intuition-of-sample-autocorrelation-using-a-scatter-plot" id="toc-explain-the-intuition-of-sample-autocorrelation-using-a-scatter-plot" class="nav-link" data-scroll-target="#explain-the-intuition-of-sample-autocorrelation-using-a-scatter-plot"><span class="header-section-number">2.6.3</span> Explain the intuition of sample autocorrelation using a scatter plot</a></li>
  <li><a href="#interpret-an-estimate-of-sample-autocorrelation-at-different-lags" id="toc-interpret-an-estimate-of-sample-autocorrelation-at-different-lags" class="nav-link" data-scroll-target="#interpret-an-estimate-of-sample-autocorrelation-at-different-lags"><span class="header-section-number">2.6.4</span> Interpret an estimate of sample autocorrelation at different lags</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sample Statistics and Correlation</h1>
<p class="subtitle lead">Chapter 2</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="functions-stuff" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="functions-stuff"><span class="header-section-number">1.1</span> Functions &amp; Stuff</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
</div>
<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
 
 function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
 }    
</script>
</section>
<section id="chapter-2" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Chapter 2</h1>
<section id="motivate-the-chapter.-why-does-it-matter" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="motivate-the-chapter.-why-does-it-matter"><span class="header-section-number">2.1</span> Motivate the chapter. Why does it matter?</h2>
<section id="connect-this-with-ch1.1" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="connect-this-with-ch1.1"><span class="header-section-number">2.1.1</span> Connect this with Ch1.1</h3>
</section>
</section>
<section id="differentiate-population-and-sample-properties-and-statistics" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="differentiate-population-and-sample-properties-and-statistics"><span class="header-section-number">2.2</span> Differentiate population and sample properties and statistics</h2>
<p>Time series are the realizations of uncertain events and processes. Uncertainty and randomness are inherent to human experience and natural phenomena. Scholars have developed a framework to study uncertainty, so before working with time series, we must build the vocabulary and tools necessary to understand and apply the science of uncertainty and risk.</p>
<section id="random-variables-and-stochastic-processes" class="level4">
<h4 class="anchored" data-anchor-id="random-variables-and-stochastic-processes"><strong>Random Variables and Stochastic Processes</strong></h4>
<p>A random variable is a numerical quantity whose value is determined by the outcome of a random process. A stochastic or random process is a collection of random variables that represent the evolution of a stochastic system over time. In time series analysis, a stochastic process can describe how a variable, such as daily temperature, changes over time. Each temperature measurement is a value of the random variable daily temperature. A sequence of temperature readings from the same location represents a time series. Each time series is a realization of the stochastic process, one of a potentially infinite number of sequences that could have been measured. In the case of daily temperatures, the stochastic process generating the data is governed by the natural processes of the earth’s weather: sun radiation, earth’s rotation, ocean temperatures, and wind patterns, among others.</p>
<p>[Insert here a simulated temperature series and it’s ensemble]</p>
<p><strong>Population and Sample</strong></p>
<p>The definitions of population and sample differentiate between all the possibilities of a stochastic process and our measurements. In statistics, a population refers to the entire set of individuals, observations, or values possible in a group of interest. It includes every possible member of the group we are studying. For example, if we are studying the heights of adult men in a country, the population would include the heights of all adult men in that country. Or if you are studying the roll of a die, it represents all the possible numerical values a die can take.</p>
<p>In the context of time series analysis, the concept of a population is called the ensemble. An ensemble represents the collection of all possible time series that a given stochastic process could generate. Each time series in the ensemble is a realization of the underlying process. For instance, consider the study of the daily temperatures in a city over ten years. The ensemble, or population, includes all possible sequences of daily temperatures that could be recorded over ten years.</p>
<p>A sample is a subset of the population selected for analysis. In the context of time series, a time series is a sample from its ensemble. In modeling daily temperature readings, a single sequence of daily temperatures observed over ten years in a specific city is a sample from the population (ensemble) of all possible temperature sequences that could have occurred under similar conditions. Unlike sampling in cross-sectional analysis, the researcher does not direct or influence the sampling process in time series analysis; the time series measured is the only sample obtained, and there is no way to repeat the process or influence it in any way.</p>
</section>
<section id="parameters-and-statistics" class="level4">
<h4 class="anchored" data-anchor-id="parameters-and-statistics"><strong>Parameters and Statistics</strong></h4>
<p>Parameters are features that describe an entire population, and the associated numerical values provide a summary measure of some aspect of the population. For example, the mean height of all adult men in a country is a parameter. In time series analysis, parameters include the mean, variance, and autocorrelation function of the entire ensemble of time series. Because parameters encompass the entire population, they are often denoted by Greek letters, such as <span class="math inline">\(\mu\)</span> for the population mean and <span class="math inline">\(\sigma^2\)</span> for the population variance.</p>
<p>Statistics, on the other hand, are features that describe a sample drawn from the population. Unlike parameters, statistics can vary depending on which individuals are included in the sample. For example, the mean height of a sample of 1,000 men selected from the population is a statistic. The sample mean from a second sample of 1,000 men will differ from the first sample. We expect the two sample means to be numerically similar because they are drawn from the same population but are unlikely to be the same. In time series analysis, statistics include the sample mean, sample variance, and sample autocorrelation function of a single time series realization. Statistics are typically denoted by Latin letters, such as <span class="math inline">\(\bar{x}\)</span> for the sample mean and <span class="math inline">\(s^2\)</span> for the sample variance.</p>
<p>Statistics, on the other hand, are features that describe a sample drawn from the population. Unlike parameters, statistics can vary depending on which individuals are included in the sample. For example, the mean height of a sample of 1,000 men selected from the population is a statistic. The sample mean from a second sample of 1,000 men will differ from the first sample. We expect the two sample means to be numerically similar because they are drawn from the same population but are unlikely to be the same. In time series analysis, statistics include the sample mean, sample variance, and sample autocorrelation function of a single time series realization. Statistics are typically denoted by Latin letters, such as <span class="math inline">\(\bar{x}\)</span> for the sample mean and <span class="math inline">\(s^2\)</span> for the sample variance.</p>
</section>
</section>
<section id="contrast-parameters-and-statistics-estimators-and-estimates" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="contrast-parameters-and-statistics-estimators-and-estimates"><span class="header-section-number">2.3</span> Contrast parameters and statistics, estimators and estimates</h2>
<section id="estimators-and-estimates" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="estimators-and-estimates"><span class="header-section-number">2.3.1</span> Estimators and Estimates</h3>
<p>An estimator is a rule or formula used to estimate a population parameter based on sample data. Estimators are functions of the observed data and are used to infer the values of unknown parameters. For example, the sample mean is an estimator used to estimate the population mean. There are preferred estimators for certain parameters; they are popular and usually spoken of as the only ones available, but note that there are many estimators for each parameter, and which one we use might depend on the context.</p>
<p>For example, consider the mean of a population as the parameter we aim to estimate. Two common estimators for this parameter are the sample and trimmed mean. The sample mean is calculated by summing all the values in a sample and then dividing by the number of values in that sample. It is a simple and widely used estimator for the population mean. On the other hand, the trimmed mean is calculated by removing a certain percentage of the smallest and largest values from the sample and then computing the mean of the remaining values. This estimator is particularly useful when the data contains outliers that might skew the sample mean. For instance, a 10% trimmed mean involves removing the lowest 10% and the highest 10% of the data points and then taking the mean of the remaining 80%. Both the sample mean and the trimmed mean aim to estimate the population mean but might yield different results depending on the presence of outliers or the distribution of the data.</p>
<p>An estimate is the numerical value obtained from an estimator when applied to a specific sample. For instance, if we calculate the mean of a sample of data points, this calculated value is the estimate of the population mean.</p>
</section>
<section id="probabililty-distributions-of-a-population-and-the-sampling-distribution-of-estimators." class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="probabililty-distributions-of-a-population-and-the-sampling-distribution-of-estimators."><span class="header-section-number">2.3.2</span> Probabililty distributions of a Population and the Sampling Distribution of Estimators.</h3>
<p>To illustrate and differentiate estimators and estimates, consider the outcomes of rolling two dice and summing the results.</p>
<p>The population in this case is the set of all possible outcomes of the sum of the two dice rolls, which ranges from 2 to 12. Each possible outcome has a theoretical probability associated with it, forming the <strong>probability distribution of the population</strong>. For example, there is only one way to roll a sum of 2 (both dice showing 1), but there are six ways to roll a sum of 7 (such as 1 and 6, 2 and 5, etc.). The probabilities for each possible sum are as follows:</p>
<ul>
<li>Sum of 2: Probability = 1/36</li>
<li>Sum of 3: Probability = 2/36</li>
<li>Sum of 4: Probability = 3/36</li>
<li>Sum of 5: Probability = 4/36</li>
<li>Sum of 6: Probability = 5/36</li>
<li>Sum of 7: Probability = 6/36</li>
<li>Sum of 8: Probability = 5/36</li>
<li>Sum of 9: Probability = 4/36</li>
<li>Sum of 10: Probability = 3/36</li>
<li>Sum of 11: Probability = 2/36</li>
<li>Sum of 12: Probability = 1/36</li>
</ul>
<p>Using these probabilities, the expected value, or mean, of the population can be calculated as</p>
<p><span class="math display">\[\mu = \sum_{i} X_i \cdot P(X_i)\]</span></p>
<p>where <span class="math inline">\(X_i\)</span> is each value that the the random variable <span class="math inline">\(X\)</span> can take, and <span class="math inline">\(P(X_i)\)</span> is the probability that <span class="math inline">\(X\)</span> takes the value <span class="math inline">\(X_i\)</span>. The expected value is a weighted average of all the possible values of <span class="math inline">\(X\)</span> weighted by how often they occur in the population.</p>
<p>In the case of the sum of two dice rolls, the expected value is</p>
<p><span class="math display">\[\mu = \sum_{X_i=2}^{12} X_i \cdot P(X_i)\]</span></p>
<p><span class="math display">\[\mu = 2 \cdot \frac{1}{36} + 3 \cdot \frac{2}{36} + 4 \cdot \frac{3}{36} + 5 \cdot \frac{4}{36} + 6 \cdot \frac{5}{36} + 7 \cdot \frac{6}{36} + 8 \cdot \frac{5}{36} + 9 \cdot \frac{4}{36} + 10 \cdot \frac{3}{36} + 11 \cdot \frac{2}{36} + 12 \cdot \frac{1}{36}\]</span></p>
<p><span class="math display">\[\mu = \frac{252}{36} = 7\]</span></p>
<p>Which interpreted means that when we draw from the population at random, we expect to roll a seven when we add the value of two dice. Seven is not the only outcome, but its the most likely outcome among all the possibilities</p>
<p>In practice, the population parameter <span class="math inline">\(\mu\)</span> is often unobserved or unknown. An estimator of <span class="math inline">\(\mu\)</span> is the sample mean <span class="math inline">\(\bar x\)</span></p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the total number of observations in the sample, and <span class="math inline">\(x_i\)</span> represents each individual observation in the sample.</p>
<p>Suppose we record the results of rolling the two dice 50 times. This set of 50 outcomes is a sample from the population distribution. We repeat this process multiple times, each time calculating the sample mean,</p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i = \frac{1}{50} \sum_{i=1}^{50} x_i
\]</span></p>
<p>the code below simulates 1000 samples of 50 observations each and creates a histogram of the sample means.The red line indicates the theoretical population mean (7).</p>
<p>A histogram is a graphical representation of the distribution of numerical data. The entire range of data is divided into a series of intervals or bins. Each bin represents a specific range of data values. The width of each bin is often the same, but this is not a strict requirement. Each bin is represented by a bar, and the height of the bar corresponds to the frequency (count) or relative frequency (probability) of data points that fall within the bin.</p>
<p>The x-axis (horizontal axis) represents the variable being measured. It is divided into intervals that correspond to the bins. The y-axis (vertical axis) represents the frequency or relative frequency of data points within each bin. For a probability histogram, the y-axis represents the probability density.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate rolling two dice 50 times and calculate sample means</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  sample_rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">36</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  sample_means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_rolls)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histogram of sample means and theoretical population mean</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sample Means of 50 Dice Rolls"</span>, <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">7</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># Theoretical population mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The estimator we used to calculate the estimates is the same, but each sample has a different samples mean (estimate). Because each sample is a subset of the population, each sample mean contains information about the population mean. However, most of the 1000 estimates are not equal to the population mean.</p>
<p>In most situations, the population parameters are unknown, but we can use the distribution of sample estimates to infer their location. The histogram above represents the sampling distribution of sample means. In general, all estimators have a sampling distribution; statistical inference relies on these distributions to estimate population parameters or conduct statistical tests.</p>
<p>The following section will introduce four parameters critical to studying time series and their respective estimators. Understanding what the parameters communicate will help us characterize the various stochastic processes that generate time series. The respective estimators will provide estimates used as evidence to match the time series we observe with the underlying stochastic processes likely to have generated it. Successful forecasting and inference rely on correctly using estimates to narrow down which stochastic process we are modeling.</p>
</section>
</section>
<section id="calculate-a-sample-standard-deviation" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="calculate-a-sample-standard-deviation"><span class="header-section-number">2.4</span> Calculate a sample standard deviation</h2>
<section id="understanding-and-calculating-the-sample-standard-deviation" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="understanding-and-calculating-the-sample-standard-deviation"><span class="header-section-number">2.4.1</span> Understanding and Calculating the Sample Standard Deviation</h3>
<p>An important feature of population is the variation of the random outcomes. One of the key measures of variability is the standard deviation.</p>
<section id="define-population-and-sample-variance-and-standard-deviation" class="level4">
<h4 class="anchored" data-anchor-id="define-population-and-sample-variance-and-standard-deviation">1.1 Define Population and Sample Variance and Standard Deviation</h4>
<p><strong>Population Variance and Standard Deviation</strong></p>
<p>Population variance <span class="math inline">\(\sigma^2\)</span> is a measure of how data points in a population are spread out around the mean. It is calculated as the average of the squared differences from the mean. Mathematically, it is expressed as</p>
<p><span class="math inline">\(\sigma^2 = \frac{1}{N} \sum_{i=1}^{N} (X_i - \mu)^2\)</span></p>
<p>where N is the size of the population, <span class="math inline">\(X_i\)</span> represents each data point in the population, and <span class="math inline">\(\mu\)</span> is the population mean</p>
<p>The population standard deviation <span class="math inline">\(\sigma\)</span> is the square root of the population variance:</p>
<p><span class="math inline">\(\sigma = \sqrt{\sigma^2}\)</span></p>
<p><strong>Sample Variance and Standard Deviation</strong></p>
<p>Sample variance <span class="math inline">\(s^2\)</span> is used to estimate the population variance from a sample. It is calculated similarly to the population variance but with a slight adjustment (Bessel’s correction) to account for the fact that the sample is only a subset of the population:</p>
<p><span class="math inline">\(s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2\)</span></p>
<p>where <span class="math inline">\(n\)</span> is the size of the sample, <span class="math inline">\(x_i\)</span> represents the value of each data point in the sample, <span class="math inline">\(\bar{x}\)</span> is the sample mean</p>
<p>The sample standard deviation <span class="math inline">\(s\)</span> is the square root of the sample variance:</p>
<p><span class="math inline">\(s = \sqrt{s^2}\)</span></p>
</section>
<section id="explain-the-intuition-behind-the-sample-standard-deviation-using-a-histogram" class="level4">
<h4 class="anchored" data-anchor-id="explain-the-intuition-behind-the-sample-standard-deviation-using-a-histogram">1.2 Explain the Intuition Behind the Sample Standard Deviation Using a Histogram</h4>
<p>To grasp the intuition behind the sample standard deviation, consider a histogram of two samples with different variances.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate daily temperatures for one year (365 days) with two different standard deviations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>temperature_data1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">365</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># Sample 1: Mean temperature = 75, standard deviation = 5</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>temperature_data2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">365</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="co"># Sample 2: Mean temperature = 75, standard deviation = 10</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample means and standard deviations</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sample_mean1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(temperature_data1)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>sample_sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(temperature_data1)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sample_mean2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(temperature_data2)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sample_sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(temperature_data2)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set x-axis limits to fit 3.5 standard deviations away from the mean on both sides</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>xlim_range <span class="ot">&lt;-</span> <span class="fu">range</span>(sample_mean2 <span class="sc">-</span> <span class="fl">3.5</span> <span class="sc">*</span> sample_sd2, sample_mean2 <span class="sc">+</span> <span class="fl">3.5</span> <span class="sc">*</span> sample_sd2)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histograms</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(temperature_data1, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sample Distribution of Daily Temperature Series"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">xlim =</span> xlim_range, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.08</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(temperature_data2, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines at the sample means</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> sample_mean1, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> sample_mean2, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display sample means and standard deviations on the plot</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Sample 1: Mean ="</span>, <span class="fu">round</span>(sample_mean1, <span class="dv">2</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sample_sd1, <span class="dv">2</span>)),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">paste</span>(<span class="st">"Sample 2: Mean ="</span>, <span class="fu">round</span>(sample_mean2, <span class="dv">2</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sample_sd2, <span class="dv">2</span>))),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)), <span class="at">border =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code generates superimposed histograms of two simulated daily temperature series, one with a standard deviation of 5 and the other with a standard deviation of 10. The blue histogram represents the sample with a standard deviation of 5, and the red histogram represents the sample with a standard deviation of 10. The dashed lines indicate the sample means of the samples by color.</p>
<p>The spread of the data points around the mean gives us an idea of the variability. The red histogram shows a broader spread, indicating higher variability. The blue histogram shows a narrower spread, indicating lower variability.</p>
<p>In the time series context, the population variance quantifies the variability or dispersion of data points around the mean for the entire ensemble. By calculating the sample variance of a time series, we can assess the extent to which the observed values deviate from the average value over the observed time frame. This measure helps identify the volatility and stability of the time series, revealing patterns and trends. Understanding the sample variance allows us to make informed inferences about the underlying stochastic process and accurately model and forecast future values.</p>
</section>
<section id="explain-a-box-and-whisker-plot" class="level4">
<h4 class="anchored" data-anchor-id="explain-a-box-and-whisker-plot">1.3 Explain a Box-and-Whisker Plot</h4>
<p>A box-and-whisker plot (or box plot) is another visualization tool that illustrates the distribution and variability of a sample. It provides a summary of the data based on five key statistics: minimum, first quartile (Q1), median (Q2), third quartile (Q3), and maximum.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box-and-whisker plots</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(temperature_data1, temperature_data2, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Sample 1"</span>, <span class="st">"Sample 2"</span>), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Box-and-Whisker Plots of Two Simulated Samples"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display sample means on the plot</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Sample 1: Mean ="</span>, <span class="fu">round</span>(sample_mean1, <span class="dv">2</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sample_sd1, <span class="dv">2</span>)),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">paste</span>(<span class="st">"Sample 2: Mean ="</span>, <span class="fu">round</span>(sample_mean2, <span class="dv">2</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sample_sd2, <span class="dv">2</span>))),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)), <span class="at">border =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code generates two box-and-whisker plots of the simulated daily temperature data. The box represents the interquartile range (IQR), showing the spread of the middle 50% of the data.The median line inside the box indicates the median temperature. The whiskers extend to the smallest and largest values within 1.5 times the IQR from Q1 and Q3. Any data points that fall outside these whiskers, known as outliers, are considered to be significantly different from the rest of the data and are plotted individually. The red dashed line represents the sample mean temperature, highlighting its position relative to the median and the overall data distribution.</p>
</section>
</section>
</section>
<section id="calculate-sample-covariance-and-correlation-coefficient." class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="calculate-sample-covariance-and-correlation-coefficient."><span class="header-section-number">2.5</span> Calculate sample covariance and correlation coefficient.</h2>
<section id="understanding-covariance-and-correlation" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="understanding-covariance-and-correlation"><span class="header-section-number">2.5.1</span> Understanding Covariance and Correlation</h3>
<p>Variance measures the variability of one random variable. In time series, we are often interested in how two random variables “move together.” Covariance and correlation measure the linear co-movements between two random variables, and sample covariance and correlation are key statistics for inferring relationships between variables. Because complex systems generate most of the data collected today, statistics that illuminate the connections between variables are the foundation of quantitative science and our understanding of complex phenomena.</p>
<section id="covariance-and-sample-covariance" class="level4">
<h4 class="anchored" data-anchor-id="covariance-and-sample-covariance">Covariance and Sample Covariance</h4>
<p><strong>Covariance</strong></p>
<p>Covariance is a measure of the degree to which two variables change together. If the variables tend to increase and decrease simultaneously, the covariance will be positive. If one variable tends to increase while the other decreases, the covariance will be negative. Mathematically, the population covariance between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is defined as:</p>
<p><span class="math display">\[\text{Cov}(X, Y) = \frac{1}{N} \sum_{i=1}^{N} (X_i - \mu_X)(Y_i - \mu_Y)\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the size of the population, <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> are the individual data points of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\mu_Y\)</span> are the means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p><strong>Sample Covariance</strong></p>
<p>Sample covariance is used to estimate the population covariance from a sample. It is calculated similarly to population covariance but uses sample data and includes Bessel’s correction to account for the sample size. The sample covariance between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is defined as:</p>
<p><span class="math display">\[s_{XY} = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the size of the sample, <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span> are the individual sample data points of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> , and <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are the sample means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
</section>
<section id="correlation-and-sample-correlation-coefficient" class="level4">
<h4 class="anchored" data-anchor-id="correlation-and-sample-correlation-coefficient">Correlation and Sample Correlation Coefficient</h4>
<p>Covariance provides a numerical expression of the magnitude of the joint variability of two variables using their units measure. For example, in a study of the relationship between height in centimeters and weight in kilograms, the covariance will have units of centimeters-kilograms. This unit dependency can make it difficult to interpret the strength of the relationship, especially when comparing covariance statistics across data sets with different units. Additionally, the scale of covariance can vary widely depending on the variability of the data, complicating its interpretation. Correlation standardizes the covariance measure, providing a dimensionless number that quantifies the strength and direction of the linear relationship between two variables. The population correlation coefficient <span class="math inline">\(\rho\)</span> between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is defined as:</p>
<p><span class="math display">\[\rho_{XY} = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}\]</span></p>
<p>where <span class="math inline">\(\text{Cov}(X, Y)\)</span> is the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and <span class="math inline">\(\sigma_X\)</span> and <span class="math inline">\(\sigma_Y\)</span> are the standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. The correlation coefficient ranges from -1 to 1. A correlation of 1 indicates a perfect positive linear relationship, while a correlation of -1 indicates a perfect negative linear relationship. A correlation of 0 indicates no linear relationship.</p>
<p><strong>Sample Correlation Coefficient</strong></p>
<p>The sample correlation coefficient <span class="math inline">\(r_{X,Y}\)</span> is the estimator <span class="math inline">\(\rho_{X,Y}\)</span> and is defined as:</p>
<p><span class="math display">\[r_{XY} = \frac{s_{XY}}{s_X s_Y}\]</span></p>
<p>where <span class="math inline">\(s_{XY}\)</span> is the sample covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and <span class="math inline">\(s_X\)</span> and <span class="math inline">\(s_Y\)</span> are the sample standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
</section>
<section id="interpreting-an-estimate-of-the-sample-correlation-coefficient" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-an-estimate-of-the-sample-correlation-coefficient">Interpreting an Estimate of the Sample Correlation Coefficient</h4>
<p>For example, consider two time series: daily temperatures and daily ice cream sales. If the sample correlation coefficient, <span class="math inline">\(r\)</span>, between these variables is 0.8, it indicates a strong positive relationship, suggesting that higher temperatures are associated with increased ice cream sales. Conversely, if <span class="math inline">\(r=-0.8\)</span>, it would suggest that higher temperatures are associated with decreased ice cream sales. A correlation value around 0 would indicate that temperature changes have little to no effect on ice cream sales.</p>
</section>
</section>
<section id="explain-the-intuition-of-covariance-using-a-scatter-plot" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="explain-the-intuition-of-covariance-using-a-scatter-plot"><span class="header-section-number">2.5.2</span> Explain the intuition of covariance using a scatter plot</h3>
<p>The following simulation explains the intuition behind the estimates for sample covariance and correlation. Please choose the size of the sample and the parameters in the population. The simulation will generate a sample and calculate, step by step, the estimates using the estimators.</p>
 <iframe id="CoAndCo" src="https://posit.byui.edu/content/564c2e71-3d0b-43a6-8c6f-d402125c8b28" style="border: none; width: 100%; height: 2200px" frameborder="0"></iframe>
</section>
</section>
<section id="calculate-a-sample-autocorrelation" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="calculate-a-sample-autocorrelation"><span class="header-section-number">2.6</span> Calculate a sample autocorrelation</h2>
<section id="autocovariance-and-autocorrelation" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="autocovariance-and-autocorrelation"><span class="header-section-number">2.6.1</span> Autocovariance and Autocorrelation</h3>
<p>As explained in Chapter 1, in cross-sectional analysis, data is collected at one point in time across multiple subjects, such as individuals, countries, company stocks, or bacteria. Sample covariance and correlation are essential statistics used to understand the relationships between variables common to all the subjects. A critical assumption in cross-sectional analysis is the independent sampling of each subject in the population. Intuitively, that means that the selection of each subject in the sample is random or not connected in any systematic way. The violation of independent sampling jeopardizes the validity of the analysis. Suppose there were connections between subjects created by the sampling process; sample covariance and correlation estimates would pick up that connection alongside the population relationship the analysis was supposed to estimate. The sampling interconnections between subjects will muddle the estimates for the population relationships, either increasing or attenuating the magnitude of the relationship, eliminating our confidence in the estimates.</p>
<p>Random sampling is impossible in time series data, which tracks a single subject over multiple periods. Because time series are collected from a single subject, each observation is inherently related to another in the series and not chosen at random. Suppose a time series tracks the height of an individual over time at a monthly frequency. Most of us would find it curious if the height of our subject increased by 10 inches in a month and then decreased by 20 inches the next month. Humans do not grow so quickly, and unless for the loss of limbs, they will not shorten that quickly either. The connection between observations in a sample implies that many of the tools of cross-sectional inference are invalid. Instead of relying on information from multiple subjects, as in cross-sectional analysis, time-series statistics use multiple sequential observations to learn about the subject.</p>
<p>The autocovariance and autocorrelation functions help us characterize the relationships between sequential observations of the same subject. The prefix “auto” comes from a Greek root meaning “self.” Like in cross-sectional analysis, where we exploit variation across subjects to find something common to all the subjects, understanding the temporal relationships in a time series will illuminate the characteristics of the stochastic process that generated the data. The measurement and analysis of autocovariance and the tools that rely on this statistic will be the foundation of most of the analysis taught in the rest of the textbook. Like cross-sectional analysis, meeting the assumptions about the autocovariance structure of the data will be the primary driver in selecting the estimators we choose for our analysis.</p>
</section>
<section id="define-population-and-sample-autocorrelation" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="define-population-and-sample-autocorrelation"><span class="header-section-number">2.6.2</span> Define population and sample autocorrelation</h3>
<p>Autocovariance and autocorrelation quantify how values in a time series relate to their past and future values, providing insights into the internal structure and patterns of the data. Because there is a temporal component in these statistics, we specify them as a function of time or lag; so there is not a single estimator of autocorrelation, like covariance, but rather an autocovariance and autocorrelation function, with one estimator for each possible time lag.</p>
<section id="autocovariance" class="level4">
<h4 class="anchored" data-anchor-id="autocovariance">Autocovariance</h4>
<p>Population autocovariance measures the covariance of a time series with a lagged version of itself for the entire ensemble, or population. It quantifies the degree to which current values of the series are related to its past values. The population autocovariance function at lag <span class="math inline">\(k\)</span> for a time series <span class="math inline">\(X_t\)</span> is defined as:</p>
<p><span class="math display">\[\gamma_k =\frac{1}{N} \sum^{N-k}_{t=1}{(X_t - \mu)(X_{t+k} - \mu)}\]</span></p>
<p>where: <span class="math inline">\(N\)</span> is the number of observations in the time series, <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_{t+k}\)</span> are the values of the series at time <span class="math inline">\(t\)</span> and <span class="math inline">\(t+k\)</span>, <span class="math inline">\(\mu\)</span> is the mean of the time series, and <span class="math inline">\(k\)</span> is the lag.</p>
<p>The collection of <span class="math inline">\(\gamma_k\)</span> for all possible lags <span class="math inline">\(k\)</span> forms the population autocovariance function, or ACVF.</p>
<p>Sample autocovariance is used to estimate the population autocovariance from a time series, not an ensemble. It is calculated similarly to the population autocovariance but uses sample data. The sample autocovariance at lag <span class="math inline">\(k\)</span> is defined as:</p>
<p><span class="math display">\[\hat{\gamma}_k = c_k =\frac{1}{n} \sum_{t=1}^{n-k} (x_t - \bar{x})(x_{t+k} - \bar{x})\]</span></p>
<p>where: <span class="math inline">\(n\)</span> is the number of observations in the sample, <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+k}\)</span> are the sample values at time <span class="math inline">\(t\)</span> and <span class="math inline">\(t+k\)</span>, <span class="math inline">\(\bar{x}\)</span> is the sample mean, and <span class="math inline">\(k\)</span> is the lag</p>
<p>The collection of <span class="math inline">\(c_k\)</span> for all possible lags <span class="math inline">\(k\)</span> forms the sample autocovariance function.</p>
</section>
<section id="autocorrelation" class="level4">
<h4 class="anchored" data-anchor-id="autocorrelation">Autocorrelation</h4>
<p>Population autocorrelation standardizes the measure of autocovariance, providing a dimensionless value that quantifies the strength and direction of the relationship between values in a time series at different lags. The population autocorrelation function at lag <span class="math inline">\(k\)</span>, denoted as <span class="math inline">\(\rho_k\)</span> is defined as:</p>
<p><span class="math display">\[\rho_k = \frac{\gamma_k}{\gamma_0}\]</span></p>
<p>where: <span class="math inline">\(\gamma_k\)</span> is the population autocovariance at lag <span class="math inline">\(k\)</span>, and <span class="math inline">\(\gamma_0\)</span> is the variance of the time series, or autocovariance at lag zero.</p>
<p>The collection of <span class="math inline">\(\rho_k\)</span> for all possible lags <span class="math inline">\(k\)</span> forms the population autocorrelation function, or ACF.</p>
<p><strong>Sample Autocorrelation</strong></p>
<p>Sample autocorrelation is used to estimate the population autocorrelation from a time series. It is defined as:</p>
<p><span class="math display">\[
  \hat{\rho}_k= r_k
    = \frac{c_k}{c_0}
    = \frac{ \frac{1}{n} \sum\limits_{t=1}^{n-k}(x_t-\bar{x})(x_{t+k}-\bar{x}) }{ \frac{1}{n} \sum\limits_{t=1}^{n}(x_t-\bar{x})^2 }
    = \frac{ \sum\limits_{t=1}^{n-k}(x_t-\bar{x})(x_{t+k}-\bar{x}) }{ \sum\limits_{t=1}^{n}(x_t-\bar{x})^2 }
\]</span></p>
<p>where: <span class="math inline">\(c_k\)</span> is the sample autocovariance at lag <span class="math inline">\(k\)</span>, <span class="math inline">\(c_0\)</span> is the sample variance of the time series, or autocovariance at lag zero.</p>
<p>The collection of <span class="math inline">\(r_k\)</span> for all possible lags <span class="math inline">\(k\)</span> forms the sample autocorrelation function.</p>
</section>
</section>
<section id="explain-the-intuition-of-sample-autocorrelation-using-a-scatter-plot" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="explain-the-intuition-of-sample-autocorrelation-using-a-scatter-plot"><span class="header-section-number">2.6.3</span> Explain the intuition of sample autocorrelation using a scatter plot</h3>
</section>
<section id="interpret-an-estimate-of-sample-autocorrelation-at-different-lags" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="interpret-an-estimate-of-sample-autocorrelation-at-different-lags"><span class="header-section-number">2.6.4</span> Interpret an estimate of sample autocorrelation at different lags</h3>
<p>The autocovariance and autocorrelation functions are a function of time. Each example that follows will show a scatter plot of a single time series against itself, lagged at different periods. The scatter plot shows the linear relationships between lagged variables and the code below each scatter plot shows the value of the autocovariance and autocorrelation functions for each lag.</p>
<p>This table and chart show ten observations from a simulation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>offset_value <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cov_df <span class="ot">&lt;-</span> <span class="fu">get_data_for_cov_table</span>(<span class="at">offset =</span> offset_value)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the number of data values.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cov_df)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>cov_df <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(t, x) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"$$ x_t $$"</span><span class="ot">=</span> x) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">t</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t $$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;">4.4</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;">4.2</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;">4.2</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">5</td>
<td style="text-align: center; min-width: 0in;">4.4</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">6</td>
<td style="text-align: center; min-width: 0in;">4.7</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">7</td>
<td style="text-align: center; min-width: 0in;">4.9</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">8</td>
<td style="text-align: center; min-width: 0in;">5.3</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">9</td>
<td style="text-align: center; min-width: 0in;">5.4</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;">5.5</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We will use the sample mean of these data repeatedly. The value of <span class="math inline">\(\bar{x}\)</span> is:</p>
<p><span class="math display">\[
  \bar x
    = \frac{1}{n} \sum\limits_{t=1}^{n} x_t
    = \frac{1}{10} \cdot 47
    = 4.7
\]</span></p>
<section id="lag-k1-sample-autocovariance-function-acvf-c_1" class="level5">
<h5 class="anchored" data-anchor-id="lag-k1-sample-autocovariance-function-acvf-c_1">Lag <span class="math inline">\(k=1\)</span> Sample Autocovariance Function (ACVF), <span class="math inline">\(c_1\)</span></h5>
<p>The lag <span class="math inline">\(k=1\)</span> sample ACVF denoted <span class="math inline">\(c_1\)</span>, is defined as</p>
<p><span class="math display">\[
  c_1 = \frac{1}{n} \sum\limits_{t=1}^{n-1}(x_t-\bar x)(x_{t+1}-\bar x)
\]</span> There are some important details to point out. Starting with the upper limit of the summation operator, <span class="math inline">\(n-1\)</span>. When we shift the series by one unit of time, we reduce the number of observations available for the calculation by one unit; for an illustration, see the table below. The inside of the summation operator there are <span class="math inline">\(n-1\)</span> values for the expression <span class="math inline">\((x_t-\bar x)(x_{t+1}-\bar x)\)</span>. The summation operator then sums all the products and divides it by the sample size, or the length of the time series.</p>
<p>Intuitively, the autocorrelation coefficient is the average of the product <span class="math inline">\((x_t-\bar x)(x_{t+1}-\bar x)\)</span>. The following table illustrates each step in the calculation.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">t</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+1} $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_t-\bar x) $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_t-\bar x)^2 $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_{t+1}-\bar x)$$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x-\bar x)(x_{t+1}-\bar x) $$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #009E73 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #009E73 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.21</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">5</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">6</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">7</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">0.04</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">8</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0.36</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.42</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">9</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.56</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.64</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">sum</td>
<td style="text-align: center; min-width: 0in;">47</td>
<td style="text-align: center; min-width: 0in;">42.6</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">2.7</td>
<td style="text-align: center; min-width: 0in;">0.3</td>
<td style="text-align: center; min-width: 0in;">2.06</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>In this example, the second variable is <span class="math inline">\(x_{t+1}\)</span>, where <span class="math inline">\(t&gt;1\)</span>. the autocovariance of <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+1}\)</span> is:</p>
<p><span class="math display">\[
  c_1
    = \frac{1}{n} \sum\limits_{t=1}^{n-1}(x_t-\bar x)(x_{t+1}-\bar x)
    = \frac{1}{10} \sum\limits_{t=1}^{9}(x_t-\bar x)(x_{t+1}-\bar x)
  = \frac{1}{10} \cdot 2.06
  = 0.206
\]</span></p>
<p>Visually, the scatter plot below illustrates the relationship between the observed data <span class="math inline">\(x_t\)</span> and the next observation <span class="math inline">\(x_{t+1}\)</span>. Note that the product <span class="math inline">\((x_t-\bar x)(x_{t+1}-\bar x)\)</span> is positive for all observations, suggesting a positive linear relationship. However, the magnitude of the relationship is difficult to evaluate give that the statistic is measured in the same units as the observations. The autocorrelation calculated in the next section will highlight the usefulness of a normalized measurement that doesn’t have the unit measurement problem of autocovariance.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lag-k1-sample-autocorrelation-function-r_1" class="level5">
<h5 class="anchored" data-anchor-id="lag-k1-sample-autocorrelation-function-r_1">Lag <span class="math inline">\(k=1\)</span> Sample Autocorrelation Function, <span class="math inline">\(r_1\)</span></h5>
<p>We can compute the autocorrelation of <span class="math inline">\(x\)</span> with lag 1 as the quotient <span class="math inline">\(r_1 = \frac{c_1}{c_0}\)</span>. We have already determined that <span class="math inline">\(c_1 = 0.206\)</span>. We now compute <span class="math inline">\(c_0\)</span>:</p>
<p><span class="math display">\[
  c_0 = \frac{1}{n} \sum\limits_{t=1}^{n-0} (x_t-\bar x)(x_{t+0}-\bar x)
    = \frac{1}{n} \sum\limits_{t=1}^{n} (x_t-\bar x)^2
    = \frac{1}{10} \cdot 2.7
    = 0.27
\]</span></p>
<p>We use <span class="math inline">\(c_0\)</span> and <span class="math inline">\(c_1\)</span> to compute <span class="math inline">\(r_1\)</span>. Here are two ways we can compute this value:</p>
<span class="math display">\[\begin{align*}
  r_1
    &amp;= \frac{c_1}{c_0}
    =
    \frac{ \frac{1}{n} \sum\limits_{t=1}^{9}(x_t-\bar x)(x_{t+1}-\bar x)
        }{
            \frac{1}{n} \sum\limits_{t=1}^{10}(x_t-\bar x)^2
        }  
    =
    \frac{
        \frac{1}{10} \cdot 2.06
      }{
        \frac{1}{10} \cdot 2.7
      }
    = \frac{0.206}{0.27}
    = 0.763
    \\
    &amp;=
    \frac{ \sum\limits_{t=1}^{9}(x_t-\bar x)(x_{t+1}-\bar x)
        }{
           \sum\limits_{t=1}^{10}(x_t-\bar x)^2
        }  
    = \frac{2.06}{2.7}
    = 0.763
    
\end{align*}\]</span>
<p>Because we are using variance of <span class="math inline">\(x_t\)</span> as the denominator in the ratio, the autocorrelation <span class="math inline">\(r_1\)</span> is bounded in the range <span class="math inline">\([-1,1]\)</span>, with zero suggesting no linear relationship. We can evaluate the strength and magnitude of the relationship because all autocorrelation estimates have the same range. The value of 0.763 suggests a strong positive correlation between between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+1}\)</span>.</p>
</section>
<section id="lag-k2-sample-autocorrelation-function-r_2" class="level5">
<h5 class="anchored" data-anchor-id="lag-k2-sample-autocorrelation-function-r_2">Lag <span class="math inline">\(k=2\)</span> Sample Autocorrelation Function, <span class="math inline">\(r_2\)</span></h5>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">t</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+2} $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t-\bar x $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_t-\bar x)^2 $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+2}-\bar x$$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x-\bar x)(x_{t+2}-\bar x) $$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #009E73 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">5</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">-0.06</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">6</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">7</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">0.04</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">8</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0.36</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.48</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">9</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.64</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">sum</td>
<td style="text-align: center; min-width: 0in;">47</td>
<td style="text-align: center; min-width: 0in;">38.4</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">2.7</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">1.21</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The autocovariance of <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+2}\)</span> is:</p>
<p><span class="math display">\[
  c_2
    = \frac{1}{n} \sum\limits_{t=1}^{n-2}(x_t-\bar x)(x_{t+2}-\bar x)
    = \frac{1}{10} \sum\limits_{t=1}^{8}(x_t-\bar x)(x_{t+2}-\bar x)
  = \frac{1}{10} \cdot 1.21
  = 0.121
\]</span></p>
<p>We use <span class="math inline">\(c_0\)</span> and <span class="math inline">\(c_2\)</span> to compute <span class="math inline">\(r_2\)</span>. Here are two ways we can compute this value:</p>
<span class="math display">\[\begin{align*}
  r_2
    &amp;= \frac{c_2}{c_0}
    =
    \frac{ \frac{1}{n} \sum\limits_{t=1}^{8}(x_t-\bar x)(x_{t+2}-\bar x)
        }{
            \frac{1}{n} \sum\limits_{t=1}^{10}(x_t-\bar x)^2
        }  
    =
    \frac{
        \frac{1}{10} \cdot 1.21
      }{
        \frac{1}{10} \cdot 2.7
      }
    = \frac{0.121}{0.27}
    = 0.4481
    \\
    &amp;=
    \frac{ \sum\limits_{t=1}^{8}(x_t-\bar x)(x_{t+2}-\bar x)
        }{
           \sum\limits_{t=1}^{10}(x_t-\bar x)^2
        }  
    = \frac{1.21}{2.7}
    = 0.4481
    
\end{align*}\]</span>
<p>Notice that the number of elements inside the summation operator is <span class="math inline">\(n-2=8\)</span>. As we increase the lag by one, the number of products <span class="math inline">\((x_t - \bar{x})(x_{t+2} - \bar{x})\)</span> is reduced by <span class="math inline">\(k=2\)</span>. For an illustration, please see the table above. The value of 0.4481 suggests a positive correlation between between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+2}\)</span>, but one that is much weaker than the autocorrelation between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+1}\)</span>.</p>
<p>The figure below illustrates the relationship between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+2}\)</span>. Please compare this scatter plot with the one for lag <span class="math inline">\(k=1\)</span> and understand the graphical differences that illustrate the difference in the magnitude of the sample autocorrelation estimates.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lag-k3-sample-autocorrelation-function-r_3" class="level5">
<h5 class="anchored" data-anchor-id="lag-k3-sample-autocorrelation-function-r_3">Lag <span class="math inline">\(k=3\)</span> Sample Autocorrelation Function, <span class="math inline">\(r_3\)</span></h5>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">t</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+3} $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t-\bar x $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_t-\bar x)^2 $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+3}-\bar x$$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x-\bar x)(x_{t+3}-\bar x) $$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #009E73 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">-0.14</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">5</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">-0.18</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">6</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">7</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">0.04</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">8</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0.36</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">9</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.64</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">sum</td>
<td style="text-align: center; min-width: 0in;">47</td>
<td style="text-align: center; min-width: 0in;">34.2</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">2.7</td>
<td style="text-align: center; min-width: 0in;">1.3</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Note that the column with the product <span class="math inline">\((x_t - \bar{x})(x_{t+3} - \bar{x})\)</span> has positive, negative, and zero values. Their average <span class="math inline">\(r_3\)</span> is close to zero, suggesting a very weak or non-existent linear relationship at lag <span class="math inline">\(k=3\)</span> The estimates for the autocovariance and autocorrelation are <span class="math inline">\(c_3 = \dfrac{0.2}{10} = 0.02\)</span> and <span class="math inline">\(r_3 = \dfrac{0.02}{0.27} =0.0741\)</span>.</p>
<p>The figure below illustrates the correlations between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+3}\)</span>. Please compare it to the prior scatter plots to understand the intuition behind the magnitude of the estimate <span class="math inline">\(r_3\)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lag-k4-sample-autocorrelation-function-r_4" class="level5">
<h5 class="anchored" data-anchor-id="lag-k4-sample-autocorrelation-function-r_4">Lag <span class="math inline">\(k=4\)</span> Sample Autocorrelation Function, <span class="math inline">\(r_4\)</span></h5>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">t</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+4} $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_t-\bar x $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x_t-\bar x)^2 $$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ x_{t+4}-\bar x$$</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">$$ (x-\bar x)(x_{t+4}-\bar x) $$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #009E73 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F0E442 !important;">4.2</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;">-0.5</td>
<td style="text-align: center; min-width: 0in;">0.25</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">-0.1</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #0072B2 !important;">4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">-0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">-0.42</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">5</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #D55E00 !important;">4.4</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">-0.3</td>
<td style="text-align: center; min-width: 0in;">0.09</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">-0.21</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">6</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #F5C710 !important;">4.7</span></td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">7</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #CC79A7 !important;">4.9</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.2</td>
<td style="text-align: center; min-width: 0in;">0.04</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">8</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #999999 !important;">5.3</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.6</td>
<td style="text-align: center; min-width: 0in;">0.36</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">9</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #E69F00 !important;">5.4</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.7</td>
<td style="text-align: center; min-width: 0in;">0.49</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;"><span style="     color: #56B4E9 !important;">5.5</span></td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">0.8</td>
<td style="text-align: center; min-width: 0in;">0.64</td>
<td style="text-align: center; min-width: 0in;">—</td>
<td style="text-align: center; min-width: 0in;">—</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">sum</td>
<td style="text-align: center; min-width: 0in;">47</td>
<td style="text-align: center; min-width: 0in;">30.2</td>
<td style="text-align: center; min-width: 0in;">0</td>
<td style="text-align: center; min-width: 0in;">2.7</td>
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;">-0.64</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>At lag <span class="math inline">\(k=4\)</span> the number of products <span class="math inline">\((x_t - \bar{x})(x_{t+4} - \bar{x})\)</span> is only six. Note that a majority are negative. The estimates for the autocovariance and autocorrelation are <span class="math inline">\(c_4 = \dfrac{-0.64}{10} = -0.064\)</span> and <span class="math inline">\(r_4 = \dfrac{-0.064}{0.27} =-0.237\)</span>. For most purposes, this autocorrelation estimate is not practically significant, there is no linear relationship at lag <span class="math inline">\(k=4\)</span>. The figure below illustrates the correlations between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+4}\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The autocovariance and autocorrelation functions are crucial tools in time series analysis, as they measure how a time series relates to its past values at different lags. Autocovariance quantifies the covariance between a time series and its lagged version, while autocorrelation standardizes this measure, providing a dimensionless value that indicates the strength and direction of the relationship. Both functions are dependent on the lag and illustrating the temporal relationship between the variables involves the analysis of multiple lags. The next section will introduce the correlogram, a single chart that shows the temporal relationships of a time series at many lags simultaneously.</p>
</section>
<section id="define-a-correlogram" class="level5">
<h5 class="anchored" data-anchor-id="define-a-correlogram">Define a Correlogram</h5>
<p>A correlogram, also known as an autocorrelation plot, visually represents the autocorrelation coefficients of a time series for different lags. This graphical tool helps identify patterns, trends, and the extent of correlations within the data over time. The table below summarizes the ACF values calculated in the previous section and five additional lags.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">0</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">4</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">5</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">6</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">7</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">8</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;">0.763</td>
<td style="text-align: center; min-width: 0in;">0.448</td>
<td style="text-align: center; min-width: 0in;">0.074</td>
<td style="text-align: center; min-width: 0in;">-0.237</td>
<td style="text-align: center; min-width: 0in;">-0.419</td>
<td style="text-align: center; min-width: 0in;">-0.47</td>
<td style="text-align: center; min-width: 0in;">-0.344</td>
<td style="text-align: center; min-width: 0in;">-0.226</td>
<td style="text-align: center; min-width: 0in;">-0.089</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="create-a-correlogram" class="level5">
<h5 class="anchored" data-anchor-id="create-a-correlogram">Create a correlogram</h5>
<p>The correlogram below consists of several key components. The primary feature is the display of autocorrelation coefficients for different lags; compare them to the table above. Each bar in the correlogram represents the correlation coefficient at a specific lag, with values ranging from -1 to 1. Values close to 1 indicate a strong positive correlation, values close to -1 indicate a strong negative correlation, and values around 0 suggest no significant correlation. The x-axis of the correlogram represents the lag values, typically starting from lag 0 (the correlation of the series with itself) and extending to higher lag values. Each lag value indicates the time shift applied to the series for computing the autocorrelation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(df<span class="sc">$</span>x, <span class="at">plot=</span><span class="cn">TRUE</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"correlation"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"ACF Plot of Simulated Data"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_2_New_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Correlograms include confidence intervals, shown as dashed horizontal lines. These intervals help assess the statistical significance of the autocorrelation coefficients. If a bar extends beyond the confidence interval, the autocorrelation at that lag is considered statistically significant. The zero line, or baseline, indicates zero correlation. Bars extending above or below this line show positive or negative correlations, respectively.</p>
<p>The statistical significance decision rule involves evaluating a hypothesis tests with each autocorrelation coefficient, one at a time. The hypothesis test uses the null hypothesis <span class="math inline">\(H_0: \rho_k = 0\)</span> which states that there is no autocorrelation in the time series at a given lag. The alternative hypothesis <span class="math inline">\(H_1: \rho_k \neq 0\)</span> states that there is significant autocorrelation at a given lag. We assume that the data follows a normal distribution centered around the value of the null hypothesis. If a autocorrelation coefficient lies outside the interval, we reject the null hypothesis for that lag, concluding that there is significant autocorrelation at that lag. If the coefficient lies within the interval, we fail to reject the null hypothesis, indicating no significant autocorrelation.</p>
<p>To create the confidence interval, first choose a significance level <span class="math inline">\(\alpha\)</span>, the default in R is 0.05. For large samples, the confidence intervals for <span class="math inline">\(\alpha=0.05\)</span> are <span class="math inline">\(0 \pm \frac{\alpha_c}{\sqrt{n}}\)</span>, where <span class="math inline">\(n\)</span> is the number of observations in the time series and <span class="math inline">\(\alpha_c\)</span> is the test’s critical value. For large samples, the critical value <span class="math inline">\(\alpha_c=1.96\)</span> corresponds to a 95% confidence level using the standard normal distribution.</p>
<p>Based on the simulated data, the autocorrelation <span class="math inline">\(r_1\)</span> is the only statistically significant temporal relationship. The value of <span class="math inline">\(r_0\)</span> is always 1 because it represents the correlation of the time series with itself and should be ignored. The estimates <span class="math inline">\(r_5\)</span> and <span class="math inline">\(r_6\)</span> are numerically large, suggesting a relationship at lags <span class="math inline">\(k=5\)</span> and <span class="math inline">\(k=6\)</span>, but neither satisfy the single hypothesis test for each lag and are not statistically different from zero.</p>
<p>There are two key points related to hypothesis testing that need to be highlighted. First, the significance level, <span class="math inline">\(\alpha\)</span>, represents the probability of making a Type I error, or false positive. A Type I error occurs when the null hypothesis is true, but we incorrectly reject it. If <span class="math inline">\(\alpha=0.05\)</span>, approximately five percent of hypothesis tests will be false positives. In correlograms with many lags, around five percent of autocorrelation coefficients will extend beyond the confidence interval thresholds. Additionally, it’s likely that the estimates <span class="math inline">\(r_k\)</span> are correlated, so adjacent estimates might fall in patterns, making interpretation of the underlying phenomenon more difficult. We don’t know which estimates are false positives, so the investigator needs to be careful when making statements about the significance of each estimate. Remember, in statistics we are never completely certain.</p>
<p>Second, statistically significant estimates might not be practically significant. As the number of observations increase the confidence interval shrinks as the standard error <span class="math inline">\(\pm \frac{1.96}{\sqrt{n}}\)</span> tends to zero. Estimates of autocorrelation coefficients that are close to zero in magnitude might be statistically significant in this case. As previously stated, five percent of the estimates will be false positives, so a practical significance rule is to report statistically significant estimates that are large in magnitude. Practically significance can be justified based on a feature of autocorrelation coefficients. The expression <span class="math inline">\(r_k^2\)</span> represents how much of the variation in <span class="math inline">\(x_t\)</span> is explained in the linear dependency between <span class="math inline">\(x_t\)</span> on <span class="math inline">\(x_k\)</span>. For estimates that are small in magnitude the explanatory power of the relationship will be diminutive rendering the estimate of no practical consequence.</p>
<p>[insert here the waves time series from the textbook]</p>
<p>In this example many estimates are statistically significant. In a chart of 25 lags approximately one estimate will be a false positive. Take <span class="math inline">\(r_17\approx0.1\)</span> for example, <span class="math inline">\(r_{17}^2\approx0.01\)</span> so only about 1% of the variation in <span class="math inline">\(x_t\)</span> is explained by the linear relationship between <span class="math inline">\(r_t\)</span> and <span class="math inline">\(r_{t+17}\)</span>. While <span class="math inline">\(r_{17}\)</span> is statistically significant it fails the practical significance test. We can’t know whether <span class="math inline">\(r_{17}\)</span> is a false positive, but it is not worth reporting regardless.</p>
<p>The pattern of estimates at adjacent lags suggest a correlation between them. This correlation make the interpretation of the individual estimates difficult since it’s clear the magnitude of <span class="math inline">\(r_4\)</span> is linked to the magnitude of <span class="math inline">\(r_3\)</span>. The next chapter will introduce the idea of trends and seasonality in time series. Trends and seasonality are relationships in sequential observations that we can estimate and account for, reducing the correlation between the time periods and allowing us to interpret autocorrelation estimates easier.</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>