<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Harmonic Seasonal Variables - Part 2 – BYU-Idaho Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter_5_lesson_4.html" rel="next">
<link href="./chapter_5_lesson_2.html" rel="prev">
<link href="./images/TSFavicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dc9ff929994d342fd2034119e2f81dae.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-4d8eee02f33473bdaf141da458b39a65.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/TSfavicon_inv.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BYU-Idaho Time Series</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Table of Contents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resource_blog.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-1">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_1.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_1_lesson_1.html">
 <span class="dropdown-text">Course Introduction</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_1_lesson_2.html">
 <span class="dropdown-text">Plots Trends, and Seasonal Variation</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="./chapter_1_lesson_3.html">
 <span class="dropdown-text">Averages for Time Series</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="./chapter_1_lesson_4.html">
 <span class="dropdown-text">Additive Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="./chapter_1_lesson_5.html">
 <span class="dropdown-text">Multiplicative Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-2">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_2.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_2_lesson_1.html">
 <span class="dropdown-text">Covariance and Correlation</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_2_lesson_2.html">
 <span class="dropdown-text">Autocorrelation Concepts</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="./chapter_2_lesson_3.html">
 <span class="dropdown-text">Exploration of Autocorrelation Concepts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-3">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_3.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_3_lesson_1.html">
 <span class="dropdown-text">Leading Variables and Associated Variables</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_3_lesson_2.html">
 <span class="dropdown-text">Exponential Smoothing (EWMA)</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="./chapter_3_lesson_3.html">
 <span class="dropdown-text">Holt-Winters Method (Additive Models) - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="./chapter_3_lesson_4.html">
 <span class="dropdown-text">Holt-Winters Method (Additive Models) - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="./chapter_3_lesson_5.html">
 <span class="dropdown-text">Holt-Winters Method (Multiplicative Models)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-4">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_4.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_4_lesson_1.html">
 <span class="dropdown-text">White Noise and Random Walks - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_4_lesson_2.html">
 <span class="dropdown-text">White Noise and Random Walks - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="./chapter_4_lesson_3.html">
 <span class="dropdown-text">Autoregressive (AR) Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="./chapter_4_lesson_4.html">
 <span class="dropdown-text">Fitted AR Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-5" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 5</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-5">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_5.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_5_lesson_1.html">
 <span class="dropdown-text">Linear Models, GLS, and Seasonal Indicator Variables</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_5_lesson_2.html">
 <span class="dropdown-text">Harmonic Seasonal Variables - Part 1</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 3</li>
        <li>
    <a class="dropdown-item" href="./chapter_5_lesson_3.html">
 <span class="dropdown-text">Harmonic Seasonal Variables - Part 2</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 4</li>
        <li>
    <a class="dropdown-item" href="./chapter_5_lesson_4.html">
 <span class="dropdown-text">Transformations and Non-Linear Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 5</li>
        <li>
    <a class="dropdown-item" href="./chapter_5_lesson_5.html">
 <span class="dropdown-text">Forecasting, Inverse Transformation, and Bias Correction</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-6" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 6</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-6">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_6.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_6_lesson_1.html">
 <span class="dropdown-text">Moving Average (MA) Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_6_lesson_2.html">
 <span class="dropdown-text">Autoregressive Moving Average (ARMA) Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-chapter-7" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Chapter 7</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-chapter-7">    
        <li class="dropdown-header">Overview</li>
        <li>
    <a class="dropdown-item" href="./chapter_7.html">
 <span class="dropdown-text">Lessons &amp; Homework</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 1</li>
        <li>
    <a class="dropdown-item" href="./chapter_7_lesson_1.html">
 <span class="dropdown-text">Introduction to Non-stationary Models and Differencing</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_7_lesson_2.html">
 <span class="dropdown-text">Seasonal ARIMA Models</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Lesson 2</li>
        <li>
    <a class="dropdown-item" href="./chapter_7_lesson_3.html">
 <span class="dropdown-text">ARCH and GARCH Models</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation">Preparation</a></li>
  <li><a href="#class-activity-monthly-average-high-temperature-in-rexburg-20-min" id="toc-class-activity-monthly-average-high-temperature-in-rexburg-20-min" class="nav-link" data-scroll-target="#class-activity-monthly-average-high-temperature-in-rexburg-20-min">Class Activity: Monthly Average High Temperature in Rexburg (20 min)</a>
  <ul class="collapse">
  <li><a href="#visualization-of-the-time-series" id="toc-visualization-of-the-time-series" class="nav-link" data-scroll-target="#visualization-of-the-time-series">Visualization of the Time Series</a></li>
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection">Model Selection</a></li>
  </ul></li>
  <li><a href="#small-group-activity-fall-river-flow-rate-35-min" id="toc-small-group-activity-fall-river-flow-rate-35-min" class="nav-link" data-scroll-target="#small-group-activity-fall-river-flow-rate-35-min">Small-Group Activity: Fall River Flow Rate (35 min)</a></li>
  <li><a href="#homework-preview-5-min" id="toc-homework-preview-5-min" class="nav-link" data-scroll-target="#homework-preview-5-min">Homework Preview (5 min)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter_5_lesson_3.html">Lesson 3</a></li><li class="breadcrumb-item"><a href="./chapter_5_lesson_3.html">Harmonic Seasonal Variables - Part 2</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Harmonic Seasonal Variables - Part 2</h1>
<p class="subtitle lead">Chapter 5: Lesson 3</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
 
 function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
 }    
</script>
<section id="learning-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h2>
<details>
<summary>
Fit linear regression models to time series data
</summary>
<ul>
<li>State the additive model with harmonic seasonal component</li>
<li>Simulate a time series with harmonic seasonal components</li>
<li>Identify an appropriate function to model the trend in a given time series</li>
<li>Identify a parsimonious set of harmonic terms for use in a regression model</li>
<li>Fit the additive model with harmonic seasonal component to real-world data</li>
<li>Evaluate residuals using a correlogram and partial correlogram to ensure they meet the assumptions</li>
</ul>
</details>
<details>
<summary>
Apply model selection criteria
</summary>
<ul>
<li>Use AIC to aid in model selection</li>
</ul>
</details>
</section>
<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<ul>
<li>Review Section 5.6</li>
</ul>
</section>
<section id="class-activity-monthly-average-high-temperature-in-rexburg-20-min" class="level2">
<h2 class="anchored" data-anchor-id="class-activity-monthly-average-high-temperature-in-rexburg-20-min">Class Activity: Monthly Average High Temperature in Rexburg (20 min)</h2>
<section id="visualization-of-the-time-series" class="level3">
<h3 class="anchored" data-anchor-id="visualization-of-the-time-series">Visualization of the Time Series</h3>
<p><a id="weather">Consider</a> the mean monthly high temperature in Rexburg.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>weather_df <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"https://byuistats.github.io/timeseries/data/rexburg_weather_monthly.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dates =</span> <span class="fu">my</span>(date_text)) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dates <span class="sc">&gt;=</span> <span class="fu">my</span>(<span class="st">"1/2008"</span>) <span class="sc">&amp;</span> dates <span class="sc">&lt;=</span> <span class="fu">my</span>(<span class="st">"12/2023"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> avg_daily_high_temp) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TIME =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos1 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos2 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos3 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos4 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos5 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos6 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin1 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin2 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin3 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin4 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin5 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin6 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> TIME)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>weather_df <span class="sc">|&gt;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> dates) <span class="sc">|&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">.vars =</span> x) <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#F0E442"</span>) <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Mean Daily High Temperature (Fahrenheit)"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Time Plot of Mean Daily Rexburg High Temperature by Month"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), endash, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), <span class="st">")"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_5_lesson_3_files/figure-html/weather1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-selection" class="level3">
<h3 class="anchored" data-anchor-id="model-selection">Model Selection</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Standardizing the Time Variable">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Standardizing the Time Variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for standardizing the time varaible -->
<section id="standardizing-the-time-variable" class="level4">
<h4 class="anchored" data-anchor-id="standardizing-the-time-variable">Standardizing the Time Variable</h4>
<p>To avoid serious floating point errors, we standardize the time variable. First, compute the sine and cosine terms using the original time variable, then transform the time variable by subtracting its mean and dividing by its standard deviation. (In other words, compute a <span class="math inline">\(z\)</span>-score.)</p>
<p>The model is adjusted accordingly after fitting.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>When the independent variable (the measure of time) is large, floating point errors in the computation of the regression coefficents can be substantial.</p>
</div>
</div>
<p>We will demonstrate standardizing the time variable below.</p>
</section>
<section id="computing-the-standardized-time-variable" class="level4">
<h4 class="anchored" data-anchor-id="computing-the-standardized-time-variable">Computing the standardized time variable</h4>
<p>Our time variable was a simple incremented value counting the months ranging from 1 (representing 1/2008) to 192 (representing 12/2023).</p>
<p>We standardize this variable by the transformation:</p>
<p><span class="math display">\[
zTIME
  = \frac{t - \bar t}{s_t}
  = \frac{t - 96.5}{55.57}
\]</span></p>
<p>where the mean of the variable <code>TIME</code> is <span class="math inline">\(\bar t = 96.5\)</span>, and the standard deviation is <span class="math inline">\(s_t = 55.57\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>weather_df <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">zTIME =</span> (TIME <span class="sc">-</span> <span class="fu">mean</span>(TIME)) <span class="sc">/</span> <span class="fu">sd</span>(TIME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we fit the trend components of the models using <code>zTIME</code> instead of <code>TIME</code>. We will start by modeling a cubic trend term.</p>
</section>
</div>
</div>
</div>
<!-- End of the Standardizing the Time Variable section -->
<!-- Model Selection: Cubic Trends -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Cubic Trends">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cubic Trends
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for cubic trends -->
<section id="cubic-trend-full-model" class="level4">
<h4 class="anchored" data-anchor-id="cubic-trend-full-model">Cubic Trend: Full Model</h4>
<p>Visually, we can identify a positive linear trend in the data. It is possible that there are higher-order properties of the trend. We will include a quadratic and cubic term in our search for a model.</p>
<p>In addition to modeling the trend, we need to include terms for the seasonal component. We start with a full model that includes all six of the the sine and cosine terms from the summation above.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cubic model with standardized time variable</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>full_cubic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">full_cubic =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6 ))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>full_cubic_lm <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 7
   .model     term        estimate std.error statistic   p.value sig  
   &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 full_cubic (Intercept)  57.2        0.405   141.    7.11e-184 TRUE 
 2 full_cubic zTIME        -0.359      0.678    -0.529 5.98e-  1 FALSE
 3 full_cubic I(zTIME^2)   -0.733      0.303    -2.42  1.67e-  2 TRUE 
 4 full_cubic I(zTIME^3)    0.586      0.348     1.68  9.41e-  2 FALSE
 5 full_cubic sin1        -16.0        0.383   -41.8   1.23e- 93 TRUE 
 6 full_cubic cos1        -23.7        0.382   -62.1   4.30e-122 TRUE 
 7 full_cubic sin2          1.29       0.382     3.37  9.34e-  4 TRUE 
 8 full_cubic cos2         -2.87       0.382    -7.51  2.74e- 12 TRUE 
 9 full_cubic sin3         -0.819      0.382    -2.15  3.33e-  2 TRUE 
10 full_cubic cos3          0.608      0.382     1.59  1.13e-  1 FALSE
11 full_cubic sin4          0.377      0.382     0.987 3.25e-  1 FALSE
12 full_cubic cos4         -0.214      0.382    -0.561 5.76e-  1 FALSE
13 full_cubic sin5         -0.0810     0.382    -0.212 8.32e-  1 FALSE
14 full_cubic cos5         -0.0433     0.382    -0.113 9.10e-  1 FALSE
15 full_cubic cos6         -0.567      0.270    -2.10  3.70e-  2 TRUE </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>forecast_df <span class="ot">&lt;-</span> full_cubic_lm <span class="sc">|&gt;</span> <span class="fu">forecast</span>(weather_df, ) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(zTIME, .mean) <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">pred =</span> .mean)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>weather_df <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(forecast_df, <span class="at">by =</span> <span class="st">"zTIME"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> dates) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">.vars =</span> x) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#F0E442"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">color =</span> <span class="st">"#56B4E9"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Mean Daily High Temperature (Fahrenheit)"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Time Plot of Mean Daily Rexburg High Temperature by Month"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), endash, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), <span class="st">")"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_5_lesson_3_files/figure-html/weather2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The cubic term in the trend is not significant, but the quadratic term is. We will fit a quadratic model.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you choose a different range of dates, you may get a different result. The regression model is fitted to the data, not to the physical situation.</p>
</div>
</div>
</section>
</div>
</div>
</div>
<!-- End hiding code for cubic model -->
<!-- Model Selection: Quadratic Trends -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Quadratic Trends">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quadratic Trends
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for quadratic trends -->
<section id="quadratic-trend-full-model" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-full-model">Quadratic Trend: Full Model</h4>
<p>We now fit a quadratic model that includes all of the seasonal terms.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>full_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">full_quadratic =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6 ))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>full_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 7
   .model         term        estimate std.error statistic   p.value sig  
   &lt;chr&gt;          &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 full_quadratic (Intercept)  57.2        0.407  141.     2.70e-184 TRUE 
 2 full_quadratic zTIME         0.688      0.273    2.52   1.25e-  2 TRUE 
 3 full_quadratic I(zTIME^2)   -0.733      0.305   -2.40   1.73e-  2 TRUE 
 4 full_quadratic sin1        -16.1        0.384  -41.8    5.46e- 94 TRUE 
 5 full_quadratic cos1        -23.7        0.384  -61.8    3.68e-122 TRUE 
 6 full_quadratic sin2          1.26       0.384    3.29   1.19e-  3 TRUE 
 7 full_quadratic cos2         -2.86       0.384   -7.44   4.03e- 12 TRUE 
 8 full_quadratic sin3         -0.832      0.384   -2.17   3.15e-  2 TRUE 
 9 full_quadratic cos3          0.620      0.384    1.62   1.08e-  1 FALSE
10 full_quadratic sin4          0.370      0.384    0.963  3.37e-  1 FALSE
11 full_quadratic cos4         -0.202      0.384   -0.525  6.00e-  1 FALSE
12 full_quadratic sin5         -0.0844     0.384   -0.220  8.26e-  1 FALSE
13 full_quadratic cos5         -0.0307     0.384   -0.0799 9.36e-  1 FALSE
14 full_quadratic cos6         -0.561      0.271   -2.07   4.01e-  2 TRUE </code></pre>
</div>
</div>
<p>The coefficient on the quadratic trend term is very small and negative. This suggests the data may indicate a decrease in the <em>rate</em> of global warming.</p>
</section>
<section id="quadratic-trend-reduced-model-1" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-1">Quadratic Trend: Reduced Model 1</h4>
<p>Eliminating the <span class="math inline">\(i=4\)</span> and <span class="math inline">\(i=5\)</span> terms, we get the model:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>reduced1_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_1  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> cos6))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>reduced1_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   .model              term        estimate std.error statistic   p.value sig  
   &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 reduced_quadratic_1 (Intercept)   57.2       0.404    142.   4.02e-188 TRUE 
 2 reduced_quadratic_1 zTIME          0.684     0.271      2.53 1.23e-  2 TRUE 
 3 reduced_quadratic_1 I(zTIME^2)    -0.733     0.303     -2.42 1.64e-  2 TRUE 
 4 reduced_quadratic_1 sin1         -16.1       0.381    -42.1  8.23e- 96 TRUE 
 5 reduced_quadratic_1 cos1         -23.7       0.381    -62.2  1.34e-124 TRUE 
 6 reduced_quadratic_1 sin2           1.26      0.381      3.32 1.09e-  3 TRUE 
 7 reduced_quadratic_1 cos2          -2.86      0.381     -7.50 2.71e- 12 TRUE 
 8 reduced_quadratic_1 sin3          -0.832     0.381     -2.18 3.02e-  2 TRUE 
 9 reduced_quadratic_1 cos3           0.621     0.381      1.63 1.05e-  1 FALSE
10 reduced_quadratic_1 cos6          -0.561     0.269     -2.08 3.86e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="quadratic-trend-reduced-model-2" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-2">Quadratic Trend: Reduced Model 2</h4>
<p>Sequentially removing the cosine term for <span class="math inline">\(i = 3\)</span>, we get:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>reduced2_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_2  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos6))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>reduced2_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_2 (Intercept)   57.2       0.406    141.   1.41e-188 TRUE 
2 reduced_quadratic_2 zTIME          0.689     0.272      2.54 1.20e-  2 TRUE 
3 reduced_quadratic_2 I(zTIME^2)    -0.733     0.304     -2.41 1.69e-  2 TRUE 
4 reduced_quadratic_2 sin1         -16.1       0.383    -41.9  8.35e- 96 TRUE 
5 reduced_quadratic_2 cos1         -23.7       0.383    -62.0  9.99e-125 TRUE 
6 reduced_quadratic_2 sin2           1.26      0.383      3.30 1.14e-  3 TRUE 
7 reduced_quadratic_2 cos2          -2.86      0.383     -7.47 3.23e- 12 TRUE 
8 reduced_quadratic_2 sin3          -0.832     0.383     -2.17 3.10e-  2 TRUE 
9 reduced_quadratic_2 cos6          -0.561     0.271     -2.07 3.95e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="quadratic-trend-reduced-model-3" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-3">Quadratic Trend: Reduced Model 3</h4>
<p>This is the quadratic model obtained by eliminating the <span class="math inline">\(i=6\)</span> term from the previous model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>reduced3_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_3  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>reduced3_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_3 (Intercept)   57.2       0.409    140.   1.12e-188 TRUE 
2 reduced_quadratic_3 zTIME          0.684     0.274      2.50 1.34e-  2 TRUE 
3 reduced_quadratic_3 I(zTIME^2)    -0.733     0.307     -2.39 1.79e-  2 TRUE 
4 reduced_quadratic_3 sin1         -16.1       0.386    -41.6  1.76e- 95 TRUE 
5 reduced_quadratic_3 cos1         -23.7       0.386    -61.4  1.63e-124 TRUE 
6 reduced_quadratic_3 sin2           1.26      0.386      3.28 1.26e-  3 TRUE 
7 reduced_quadratic_3 cos2          -2.86      0.386     -7.40 4.67e- 12 TRUE 
8 reduced_quadratic_3 sin3          -0.832     0.386     -2.16 3.25e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="quadratic-trend-reduced-model-4" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-4">Quadratic Trend: Reduced Model 4</h4>
<p>This is similar to the previous model, except both the sine and cosine terms are included for <span class="math inline">\(i=3\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>reduced4_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_4  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>reduced4_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_4 (Intercept)   57.2       0.408    140.   3.22e-188 TRUE 
2 reduced_quadratic_4 zTIME          0.679     0.273      2.49 1.38e-  2 TRUE 
3 reduced_quadratic_4 I(zTIME^2)    -0.733     0.305     -2.40 1.74e-  2 TRUE 
4 reduced_quadratic_4 sin1         -16.1       0.385    -41.8  1.76e- 95 TRUE 
5 reduced_quadratic_4 cos1         -23.7       0.384    -61.7  2.21e-124 TRUE 
6 reduced_quadratic_4 sin2           1.26      0.384      3.29 1.21e-  3 TRUE 
7 reduced_quadratic_4 cos2          -2.86      0.384     -7.43 3.95e- 12 TRUE 
8 reduced_quadratic_4 sin3          -0.832     0.384     -2.16 3.17e-  2 TRUE 
9 reduced_quadratic_4 cos3           0.621     0.384      1.61 1.08e-  1 FALSE</code></pre>
</div>
</div>
</section>
<section id="quadratic-trend-reduced-model-5" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-5">Quadratic Trend: Reduced Model 5</h4>
<p>This quadratic model only includes the <span class="math inline">\(i=1\)</span> and <span class="math inline">\(i=2\)</span> terms.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>reduced5_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>reduced5_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_5 (Intercept)   57.2       0.413    138.   1.06e-188 TRUE 
2 reduced_quadratic_5 zTIME          0.692     0.277      2.50 1.33e-  2 TRUE 
3 reduced_quadratic_5 I(zTIME^2)    -0.733     0.310     -2.37 1.90e-  2 TRUE 
4 reduced_quadratic_5 sin1         -16.1       0.390    -41.2  4.40e- 95 TRUE 
5 reduced_quadratic_5 cos1         -23.7       0.390    -60.8  3.16e-124 TRUE 
6 reduced_quadratic_5 sin2           1.26      0.390      3.24 1.40e-  3 TRUE 
7 reduced_quadratic_5 cos2          -2.86      0.390     -7.33 6.96e- 12 TRUE </code></pre>
</div>
</div>
</section>
<section id="quadratic-trend-reduced-model-6" class="level4">
<h4 class="anchored" data-anchor-id="quadratic-trend-reduced-model-6">Quadratic Trend: Reduced Model 6</h4>
<p>This model includes a quadratic effect for time, but only includes the sine and cosine terms corresponding to <span class="math inline">\(i=1\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>reduced6_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_6  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>reduced6_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_6 (Intercept)   57.2       0.477    120.   9.32e-179 TRUE 
2 reduced_quadratic_6 zTIME          0.646     0.319      2.02 4.45e-  2 TRUE 
3 reduced_quadratic_6 I(zTIME^2)    -0.734     0.358     -2.05 4.14e-  2 TRUE 
4 reduced_quadratic_6 sin1         -16.1       0.451    -35.7  2.32e- 85 TRUE 
5 reduced_quadratic_6 cos1         -23.7       0.450    -52.7  4.14e-114 TRUE </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
<!-- End quadratic model -->
<!-- Model Selection: Linear Trend -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Linear Trends">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Linear Trends
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for linear trends -->
<section id="linear-trend-full-model" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-full-model">Linear Trend: Full Model</h4>
<p>This is the full model with a linear time component. All of the period functions are included from <span class="math inline">\(i=1\)</span> to <span class="math inline">\(i=6\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>full_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">full_linear =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6 ))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>full_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
   .model      term        estimate std.error statistic   p.value sig  
   &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 full_linear (Intercept)  56.5        0.275  205.     2.02e-214 TRUE 
 2 full_linear zTIME         0.688      0.276    2.49   1.37e-  2 TRUE 
 3 full_linear sin1        -16.1        0.389  -41.3    2.19e- 93 TRUE 
 4 full_linear cos1        -23.7        0.389  -61.0    1.16e-121 TRUE 
 5 full_linear sin2          1.26       0.389    3.25   1.38e-  3 TRUE 
 6 full_linear cos2         -2.86       0.389   -7.35   6.86e- 12 TRUE 
 7 full_linear sin3         -0.832      0.389   -2.14   3.37e-  2 TRUE 
 8 full_linear cos3          0.620      0.389    1.59   1.13e-  1 FALSE
 9 full_linear sin4          0.370      0.389    0.950  3.43e-  1 FALSE
10 full_linear cos4         -0.202      0.389   -0.518  6.05e-  1 FALSE
11 full_linear sin5         -0.0845     0.389   -0.217  8.28e-  1 FALSE
12 full_linear cos5         -0.0307     0.389   -0.0789 9.37e-  1 FALSE
13 full_linear cos6         -0.561      0.275   -2.04   4.28e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-1" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-1">Linear Trend: Reduced Model 1</h4>
<p>This linear model excludes the terms corresponding to <span class="math inline">\(i=4\)</span> and <span class="math inline">\(i=5\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>reduced1_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_1  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> cos6))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>reduced1_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_1 (Intercept)   56.5       0.273    207.   6.64e-219 TRUE 
2 reduced_linear_1 zTIME          0.684     0.274      2.49 1.35e-  2 TRUE 
3 reduced_linear_1 sin1         -16.1       0.386    -41.6  3.44e- 95 TRUE 
4 reduced_linear_1 cos1         -23.7       0.386    -61.4  4.39e-124 TRUE 
5 reduced_linear_1 sin2           1.26      0.386      3.27 1.26e-  3 TRUE 
6 reduced_linear_1 cos2          -2.86      0.386     -7.40 4.65e- 12 TRUE 
7 reduced_linear_1 sin3          -0.832     0.386     -2.16 3.24e-  2 TRUE 
8 reduced_linear_1 cos3           0.620     0.386      1.61 1.10e-  1 FALSE
9 reduced_linear_1 cos6          -0.561     0.273     -2.06 4.12e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-2" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-2">Linear Trend: Reduced Model 2</h4>
<p>This represents the reduction of the previous model by eliminating the cosine term for <span class="math inline">\(i=3\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>reduced2_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_2  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos6))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>reduced2_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_2 (Intercept)   56.5       0.274    206.   1.56e-219 TRUE 
2 reduced_linear_2 zTIME          0.689     0.275      2.50 1.31e-  2 TRUE 
3 reduced_linear_2 sin1         -16.1       0.388    -41.4  3.41e- 95 TRUE 
4 reduced_linear_2 cos1         -23.7       0.388    -61.2  3.22e-124 TRUE 
5 reduced_linear_2 sin2           1.26      0.388      3.26 1.32e-  3 TRUE 
6 reduced_linear_2 cos2          -2.86      0.388     -7.37 5.48e- 12 TRUE 
7 reduced_linear_2 sin3          -0.832     0.388     -2.15 3.31e-  2 TRUE 
8 reduced_linear_2 cos6          -0.561     0.274     -2.05 4.20e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-3" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-3">Linear Trend: Reduced Model 3</h4>
<p>This model is similar to the previous one, but the cosine term associated with <span class="math inline">\(i=6\)</span> has been excluded.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>reduced3_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_3  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>reduced3_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_3 (Intercept)   56.5       0.276    204.   8.13e-220 TRUE 
2 reduced_linear_3 zTIME          0.684     0.278      2.47 1.46e-  2 TRUE 
3 reduced_linear_3 sin1         -16.1       0.391    -41.1  6.93e- 95 TRUE 
4 reduced_linear_3 cos1         -23.7       0.391    -60.6  5.06e-124 TRUE 
5 reduced_linear_3 sin2           1.26      0.391      3.23 1.45e-  3 TRUE 
6 reduced_linear_3 cos2          -2.86      0.391     -7.31 7.77e- 12 TRUE 
7 reduced_linear_3 sin3          -0.832     0.391     -2.13 3.46e-  2 TRUE </code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-4" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-4">Linear Trend: Reduced Model 4</h4>
<p>This model consists of a linear trend with all the periodic terms associated with <span class="math inline">\(i=1\)</span> through <span class="math inline">\(i=3\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>reduced4_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_4  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>reduced4_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_4 (Intercept)   56.5       0.275    205.   3.50e-219 TRUE 
2 reduced_linear_4 zTIME          0.679     0.276      2.45 1.50e-  2 TRUE 
3 reduced_linear_4 sin1         -16.1       0.390    -41.2  7.05e- 95 TRUE 
4 reduced_linear_4 cos1         -23.7       0.389    -60.9  6.98e-124 TRUE 
5 reduced_linear_4 sin2           1.26      0.389      3.25 1.39e-  3 TRUE 
6 reduced_linear_4 cos2          -2.86      0.389     -7.34 6.63e- 12 TRUE 
7 reduced_linear_4 sin3          -0.832     0.389     -2.14 3.38e-  2 TRUE 
8 reduced_linear_4 cos3           0.620     0.389      1.59 1.13e-  1 FALSE</code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-5" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-5">Linear Trend: Reduced Model 5</h4>
<p>This model has a linear trend and only includes the periodic terms corresponding to <span class="math inline">\(i=1\)</span> and <span class="math inline">\(i=2\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>reduced5_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>reduced5_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_5 (Intercept)   56.5       0.279    202.   5.06e-220 TRUE 
2 reduced_linear_5 zTIME          0.692     0.280      2.47 1.44e-  2 TRUE 
3 reduced_linear_5 sin1         -16.1       0.395    -40.7  1.66e- 94 TRUE 
4 reduced_linear_5 cos1         -23.7       0.395    -60.1  9.40e-124 TRUE 
5 reduced_linear_5 sin2           1.26      0.395      3.20 1.60e-  3 TRUE 
6 reduced_linear_5 cos2          -2.86      0.395     -7.24 1.13e- 11 TRUE </code></pre>
</div>
</div>
</section>
<section id="linear-trend-reduced-model-6" class="level4">
<h4 class="anchored" data-anchor-id="linear-trend-reduced-model-6">Linear Trend: Reduced Model 6</h4>
<p>This simple model includes a linear trend and period terms associated with <span class="math inline">\(i=1\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>reduced6_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_6  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>reduced6_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_6 (Intercept)   56.5       0.321    176.   1.43e-210 TRUE 
2 reduced_linear_6 zTIME          0.646     0.322      2.01 4.63e-  2 TRUE 
3 reduced_linear_6 sin1         -16.1       0.454    -35.4  5.09e- 85 TRUE 
4 reduced_linear_6 cos1         -23.7       0.454    -52.2  7.20e-114 TRUE </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
<!-- End of linear model output -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Model Comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for model comparison -->
<section id="model-comparison" class="level4">
<h4 class="anchored" data-anchor-id="model-comparison">Model Comparison</h4>
<p>Now, we compare all the models side-by-side.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model_combined <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_cubic =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_quadratic =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_linear =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME  <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>      sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> cos6 ),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_1  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> cos6),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_2  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos6),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_3  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_4  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_quadratic_6  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> <span class="fu">I</span>(TIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_1  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> cos6),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_2  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos6),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_3  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3),</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_4  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 <span class="sc">+</span> sin3 <span class="sc">+</span> cos3),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduced_linear_6  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> TIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model_combined) <span class="sc">|&gt;</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.model, AIC, AICc, BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">full_cubic</td>
<td style="text-align: center; min-width: 0in;">523</td>
<td style="text-align: center; min-width: 0in;">526.1</td>
<td style="text-align: center; min-width: 0in;">575.1</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">full_quadratic</td>
<td style="text-align: center; min-width: 0in;">524.1</td>
<td style="text-align: center; min-width: 0in;">526.8</td>
<td style="text-align: center; min-width: 0in;">572.9</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">full_linear</td>
<td style="text-align: center; min-width: 0in;">528.2</td>
<td style="text-align: center; min-width: 0in;">530.6</td>
<td style="text-align: center; min-width: 0in;">573.8</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_1</td>
<td style="text-align: center; min-width: 0in;">**517.4**</td>
<td style="text-align: center; min-width: 0in;">**518.9**</td>
<td style="text-align: center; min-width: 0in;">553.3</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_2</td>
<td style="text-align: center; min-width: 0in;">518.2</td>
<td style="text-align: center; min-width: 0in;">519.4</td>
<td style="text-align: center; min-width: 0in;">550.8</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_3</td>
<td style="text-align: center; min-width: 0in;">520.7</td>
<td style="text-align: center; min-width: 0in;">521.7</td>
<td style="text-align: center; min-width: 0in;">550</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_4</td>
<td style="text-align: center; min-width: 0in;">520</td>
<td style="text-align: center; min-width: 0in;">521.2</td>
<td style="text-align: center; min-width: 0in;">552.5</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_5</td>
<td style="text-align: center; min-width: 0in;">523.5</td>
<td style="text-align: center; min-width: 0in;">524.2</td>
<td style="text-align: center; min-width: 0in;">**549.5**</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_quadratic_6</td>
<td style="text-align: center; min-width: 0in;">576.7</td>
<td style="text-align: center; min-width: 0in;">577.1</td>
<td style="text-align: center; min-width: 0in;">596.2</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_linear_1</td>
<td style="text-align: center; min-width: 0in;">521.5</td>
<td style="text-align: center; min-width: 0in;">522.7</td>
<td style="text-align: center; min-width: 0in;">554.1</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_linear_2</td>
<td style="text-align: center; min-width: 0in;">522.2</td>
<td style="text-align: center; min-width: 0in;">523.2</td>
<td style="text-align: center; min-width: 0in;">551.5</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_linear_3</td>
<td style="text-align: center; min-width: 0in;">524.5</td>
<td style="text-align: center; min-width: 0in;">525.3</td>
<td style="text-align: center; min-width: 0in;">550.6</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_linear_4</td>
<td style="text-align: center; min-width: 0in;">523.9</td>
<td style="text-align: center; min-width: 0in;">524.9</td>
<td style="text-align: center; min-width: 0in;">553.2</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">reduced_linear_5</td>
<td style="text-align: center; min-width: 0in;">527.2</td>
<td style="text-align: center; min-width: 0in;">527.8</td>
<td style="text-align: center; min-width: 0in;">550</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">reduced_linear_6</td>
<td style="text-align: center; min-width: 0in;">579</td>
<td style="text-align: center; min-width: 0in;">579.3</td>
<td style="text-align: center; min-width: 0in;">595.2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We look for the smallest value of the AIC, AICc, and BIC criteria. These methods do not have to agree with each other, and they provide different perspectives based on their various algorithms. Notice that the AIC and AICc criteria both suggest the model we titled “Reduced Quadratic 1:”</p>
<p><span class="math display">\[\begin{align*}
  x_t &amp;= \beta_0 + \beta_1 \left( \frac{t - \mu_t}{\sigma_t} \right) + \beta_2 \left( \frac{t - \mu_t}{\sigma_t} \right)^2
                        + \beta_3 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
                        + \beta_4 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + \beta_5 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
                        + \beta_6 \cos \left( \frac{2\pi \cdot 2 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + \beta_7 \sin \left( \frac{2\pi \cdot 3 t}{12} \right)  
                        + \beta_8 \cos \left( \frac{2\pi \cdot 3 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + \beta_9 \cos \left( \frac{2\pi \cdot 6 t}{12} \right)
               \phantom{+ \beta_9 \sin \left( \frac{2\pi \cdot 6 t}{12} \right)}
      + z_t
\end{align*}\]</span></p>
<p>The BIC criteria points to the “Reduced Quadratic 5” model:</p>
<p><span class="math display">\[\begin{align*}
  x_t &amp;= \beta_0 + \beta_1 \left( \frac{t - \mu_t}{\sigma_t} \right) + \beta_2 \left( \frac{t - \mu_t}{\sigma_t} \right)^2
            + \beta_3 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \beta_4 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + \beta_5 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \beta_6 \cos \left( \frac{2\pi \cdot 2 t}{12} \right) + z_t
\end{align*}\]</span></p>
<p>If there are two competing models that are both satisfactory, it is usually preferable to choose the more parsimonious (or simpler) model.</p>
<p>Sometimes there will be a model that does not attain the lowest value of these measures, yet you may still want to use it if the AIC, AICc, and BIC values are not too much larger than the smallest values. Why might you do this? If the model is particularly interpretable or makes logical sense in the context of the physical situation, it is better than a model with a lower AIC that is not readily interpretable.</p>
<p>You may even choose to include terms that are not statistically significant, if you determine they are practically important. For example, if a quadratic term is significant, but the linear term is not, it is a good practice to include the linear term anyway.</p>
<p>Notice that the linear models corresponding to the “Reduced Quadratic 1” and “Reduced Quadratic 5” models have AIC/AICc/BIC values that are not much larger than the minimum values. Given other external evidence related to global warming, it is unlikely that the second derivative of the function representing the Earth’s mean temperature is negative. In other words, it does not seem like the rate at which the earth is warming is decreasing. Even if there is a quadratic component to the trend, it is not visible to the eye in the time plot.</p>
<p>For these reasons, we will apply the “Reduced Linear 5” model. This model implies a linear trend in the mean temperature of the Earth. The BIC for this model is not much bigger than the BIC for the “Reduced Quadratic 5” model. This model is simpler than the “Reduced Quadratic 1,” “Reduced Quadratic 5,” and “Reduced Linear 1” models.</p>
<p><span class="math display">\[\begin{align*}
  x_t &amp;= \beta_0 + \beta_1 \left( \frac{t - \mu_t}{\sigma_t} \right)  
            + \beta_2 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \beta_3 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + \beta_4 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \beta_5 \cos \left( \frac{2\pi \cdot 2 t}{12} \right) + z_t
\end{align*}\]</span></p>
</section>
</div>
</div>
</div>
<!-- End of model comparison -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Model Fitting">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Fitting
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for model fitting -->
<section id="model-fitting" class="level4">
<h4 class="anchored" data-anchor-id="model-fitting">Model Fitting</h4>
<p>The model we have chosen is the “Reduced Linear 5” model. For convenience, we reprint the coefficients here.</p>
<section id="reduced-linear-5" class="level5">
<h5 class="anchored" data-anchor-id="reduced-linear-5">Reduced Linear 5</h5>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>reduced5_linear_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_linear_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>reduced5_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  .model           term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_linear_5 (Intercept)   56.5       0.279    202.   5.06e-220 TRUE 
2 reduced_linear_5 zTIME          0.692     0.280      2.47 1.44e-  2 TRUE 
3 reduced_linear_5 sin1         -16.1       0.395    -40.7  1.66e- 94 TRUE 
4 reduced_linear_5 cos1         -23.7       0.395    -60.1  9.40e-124 TRUE 
5 reduced_linear_5 sin2           1.26      0.395      3.20 1.60e-  3 TRUE 
6 reduced_linear_5 cos2          -2.86      0.395     -7.24 1.13e- 11 TRUE </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>r5lin_coef_unrounded <span class="ot">&lt;-</span> reduced5_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>r5lin_coef <span class="ot">&lt;-</span> r5lin_coef_unrounded <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round_df</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The fitted model is therefore:</p>
<p><span class="math display">\[\begin{align*}
  x_t &amp;= \hat \beta_0 + \hat \beta_1 \left( zTIME \right)  \\
      &amp; ~~~~~~~~~~ + \hat \beta_2 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \hat \beta_3 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~ + \hat \beta_4 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \hat \beta_5 \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= \hat \beta_0 + \hat \beta_1 \left( \frac{t - \bar t}{s_t} \right)  \\
      &amp; ~~~~~~~~~~ + \hat \beta_2 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \hat \beta_3 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~ + \hat \beta_4 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \hat \beta_5 \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= 56.467
            + 0.692 \left( \frac{t - 96.5}{55.57} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.068) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.708) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.264 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.858) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
\end{align*}\]</span></p>
<p>The linear trend term can be simplified, if desired, but it is not necessary.</p>
<p><span class="math display">\[\begin{align*}
  x_t
      &amp;= 56.467
            + 0.692 \left( \frac{t - 96.5}{55.57} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.068) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.708) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.264 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.858) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= 56.467
            + 0.692 \left( \frac{t}{55.57} \right)
            - 0.692 \left( \frac{96.5}{55.57} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.068) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.708) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.264 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.858) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)  
      \\
      &amp;= 56.467
            + 0.012 t
            - 1.201 \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.068) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.708) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.264 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.858) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= 55.265
            + 0.012 t  \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.068) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.708) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.264 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.858) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
\end{align*}\]</span></p>
<!-- ::: {.callout-important icon=false title="Comparison of Standardized and Unstandardized Time Variable" collapse="true"} -->
<!-- <!-- Begin code for comparison of unstandardized and standardized time variables -->
<p>–&gt;</p>
<!-- #### Comparison of Standardized and Unstandardized Time Variable -->
<!-- For comparison, note the values of the parameters if we fit the same model without standardizing the time variable: -->
<!-- ```{r} -->
<!-- #| label: weather2a -->
<!-- #| code-fold: true -->
<!-- #| code-summary: "Show the code" -->
<!-- # Reduced linear 5 model with unstandardized time variable -->
<!-- reduced5_linear_lm_unstandardized <- weather_df |> -->
<!--   model(reduced_linear_5_unstandardized  = TSLM(x ~ TIME + sin1 + cos1 + sin2 + cos2)) -->
<!-- reduced5_linear_lm_unstandardized |> -->
<!--   tidy() |> -->
<!--   mutate(sig = p.value < 0.05) -->
<!-- r5lin_unstd_coef_unrounded <- reduced5_linear_lm_unstandardized |> -->
<!--   tidy() |> -->
<!--   select(term, estimate, std.error) -->
<!-- r5lin_unstd_coef <- r5lin_unstd_coef_unrounded |> -->
<!--   round_df(3) -->
<!-- r5lin_unstd_coef$estimate -->
<!-- ``` -->
<!-- Notice that the variable `TIME` is statistically significant for the unstandardized case but not the standardized case. -->
<!-- :::  -->
<!-- <!-- End of collapsed comparison of models -->
<p>–&gt;</p>
</section>
<section id="reduced-quadratic-5" class="level5">
<h5 class="anchored" data-anchor-id="reduced-quadratic-5">Reduced Quadratic 5</h5>
<p>To illustrate how to incorporate the quadratic term, we also fit the model called “Reduced Quadratic 5”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>reduced5_quadratic_lm <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">reduced_quadratic_5  =</span> <span class="fu">TSLM</span>(x <span class="sc">~</span> zTIME <span class="sc">+</span> <span class="fu">I</span>(zTIME<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>reduced5_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  .model              term        estimate std.error statistic   p.value sig  
  &lt;chr&gt;               &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
1 reduced_quadratic_5 (Intercept)   57.2       0.413    138.   1.06e-188 TRUE 
2 reduced_quadratic_5 zTIME          0.692     0.277      2.50 1.33e-  2 TRUE 
3 reduced_quadratic_5 I(zTIME^2)    -0.733     0.310     -2.37 1.90e-  2 TRUE 
4 reduced_quadratic_5 sin1         -16.1       0.390    -41.2  4.40e- 95 TRUE 
5 reduced_quadratic_5 cos1         -23.7       0.390    -60.8  3.16e-124 TRUE 
6 reduced_quadratic_5 sin2           1.26      0.390      3.24 1.40e-  3 TRUE 
7 reduced_quadratic_5 cos2          -2.86      0.390     -7.33 6.96e- 12 TRUE </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>r5quad_coef <span class="ot">&lt;-</span> reduced5_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round_df</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The fitted model is:</p>
<p><span class="math display">\[\begin{align*}
  x_t &amp;= \hat \beta_0 + \hat \beta_1 \left( zTIME \right) + \hat \beta_2 \left( zTIME \right)^2  \\
      &amp; ~~~~~~~~~~ + \hat \beta_3 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \hat \beta_4 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~ + \hat \beta_5 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \hat \beta_6 \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= \hat \beta_0 + \hat \beta_1 \left( \frac{t - \bar t}{s_t} \right) + \hat \beta_2 \left( \frac{t - \bar t}{s_t} \right)^2 \\
      &amp; ~~~~~~~~~~ + \hat \beta_3 \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + \hat \beta_4 \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~ + \hat \beta_5 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + \hat \beta_6 \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
      &amp;= 57.196
            + 0.692 \left( \frac{t - 96.5}{55.57} \right)
            + (-0.733) \left( \frac{t - 96.5}{55.57} \right)^2 \\
      &amp; ~~~~~~~~~~~~~~~~~ + (-16.067) \sin \left( \frac{2\pi \cdot 1 t}{12} \right)
            + (-23.705) \cos \left( \frac{2\pi \cdot 1 t}{12} \right) \\
      &amp; ~~~~~~~~~~~~~~~~~ + 1.265 \sin \left( \frac{2\pi \cdot 2 t}{12} \right)
            + (-2.857) \cos \left( \frac{2\pi \cdot 2 t}{12} \right)
      \\
\end{align*}\]</span></p>
<p>If we want, we could rewrite this by expanding out the polynomial in the first three terms, but it is not necessary.</p>
</section>
</section>
</div>
</div>
</div>
<!-- End of Model Fitting -->
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Comparison of Fitted Values">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparison of Fitted Values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<!-- Begin hiding code for Comparison of Fitted Values -->
<section id="comparison-of-fitted-values" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-fitted-values">Comparison of Fitted Values</h4>
<p>This time plot shows the original temperature data superimposed with the fitted curves based on three models.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>num_months <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(TIME) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">TIME =</span> <span class="fu">seq</span>(<span class="dv">1</span>, num_months, <span class="fl">0.01</span>) ) <span class="sc">|&gt;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos1 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos2 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos3 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos4 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos5 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos6 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin1 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin2 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin3 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin4 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin5 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin6 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME<span class="sc">/</span><span class="dv">12</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">zTIME =</span> (TIME <span class="sc">-</span> <span class="fu">mean</span>(TIME)) <span class="sc">/</span> <span class="fu">sd</span>(TIME)) <span class="sc">|&gt;</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> TIME)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>quad1_ts <span class="ot">&lt;-</span> reduced1_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(df) <span class="sc">|&gt;</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(TIME, .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"Quadratic 1"</span>)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>quad5_ts <span class="ot">&lt;-</span> reduced5_quadratic_lm <span class="sc">|&gt;</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(df) <span class="sc">|&gt;</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(TIME, .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"Quadratic 5"</span>)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>linear5_ts <span class="ot">&lt;-</span> reduced5_linear_lm <span class="sc">|&gt;</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(df) <span class="sc">|&gt;</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(TIME, .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> .mean) <span class="sc">|&gt;</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"Linear 5"</span>)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>data_ts <span class="ot">&lt;-</span> weather_df <span class="sc">|&gt;</span> </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"Data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(TIME, value, Model)</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>combined_ts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_ts, quad1_ts, quad5_ts, linear5_ts) </span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>point_ts <span class="ot">&lt;-</span> combined_ts <span class="sc">|&gt;</span> <span class="fu">filter</span>(TIME <span class="sc">==</span> <span class="fu">floor</span>(TIME))</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>okabe_ito_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>combined_ts <span class="sc">|&gt;</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> value, <span class="at">color =</span> Model)) <span class="sc">+</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> point_ts) <span class="sc">+</span></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Month Number"</span>,</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Temperature (Fahrenheit)"</span>,</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Monthly Average of Daily High Temperatures in Rexburg"</span>,</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), endash, <span class="fu">format</span>(weather_df<span class="sc">$</span>dates <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">1</span>), <span class="st">"%b %Y"</span>), <span class="st">")"</span>)</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>    </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> okabe_ito_colors[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combined_ts <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> <span class="fu">select</span>(Model) <span class="sc">|&gt;</span> <span class="fu">unique</span>())], </span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span></span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="co"># Position the legend at the top</span></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span> <span class="co"># Set the legend direction to horizontal</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_5_lesson_3_files/figure-html/weather19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
<!-- End of Comparison of Fitted Values -->
</section>
</section>
<section id="small-group-activity-fall-river-flow-rate-35-min" class="level2">
<h2 class="anchored" data-anchor-id="small-group-activity-fall-river-flow-rate-35-min">Small-Group Activity: Fall River Flow Rate (35 min)</h2>
<p>The Fall River is a tributary of the Henrys Fork of the Snake River northeast of Rexburg, Idaho. The United States Geological Survey (USGS) provides data every fifteen minutes on the flow rate (in cubic feet per second, cfs) of this river.</p>
<p>This map shows the location of the monitoring station. On the left, you can see where Highway 20 intersects with Main St.&nbsp;in Ashton, Idaho.</p>
<p><img src="images/fallriver_map.png" class="img-fluid" alt="Map of the fall river monitoring station"> Here is a glimpse of the raw data:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">agency_cd</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">site_no</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">datetime</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">flow</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">1998-10-01 00:00 MDT</td>
<td style="text-align: center; min-width: 0in;">662</td>
<td style="text-align: center; min-width: 0in;">A:[91]</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">1998-10-01 00:15 MDT</td>
<td style="text-align: center; min-width: 0in;">655</td>
<td style="text-align: center; min-width: 0in;">A:[91]</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">1998-10-01 00:30 MDT</td>
<td style="text-align: center; min-width: 0in;">655</td>
<td style="text-align: center; min-width: 0in;">A:[91]</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">1998-10-01 00:45 MDT</td>
<td style="text-align: center; min-width: 0in;">662</td>
<td style="text-align: center; min-width: 0in;">A:[91]</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">2023-09-30 23:00 MDT</td>
<td style="text-align: center; min-width: 0in;">547</td>
<td style="text-align: center; min-width: 0in;">A</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">2023-09-30 23:15 MDT</td>
<td style="text-align: center; min-width: 0in;">547</td>
<td style="text-align: center; min-width: 0in;">A</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">2023-09-30 23:30 MDT</td>
<td style="text-align: center; min-width: 0in;">547</td>
<td style="text-align: center; min-width: 0in;">A</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">USGS</td>
<td style="text-align: center; min-width: 0in;">13046995</td>
<td style="text-align: center; min-width: 0in;">2023-09-30 23:45 MDT</td>
<td style="text-align: center; min-width: 0in;">552</td>
<td style="text-align: center; min-width: 0in;">A</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The 2023 water year goes from October 1, 2022 to September 30, 2023. The data starts with the 1999 water year and goes through the 2023 water year.</p>
<p>We will average the flow rates across the first and last half of each month, so there are 24 values in a year. For various reasons, there are gaps in the data, even after averaging across the first and last half of the month. We impute the missing values by linear interpolation using the <code>zoo</code> package. This just means that when we encounter NAs, we fit a line between the most recent observed value and the next observed value. Then, we fill all the NAs in with the value given by the liner relationship between the two points.</p>
<p>Here are a few of the values, after averaging:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load necessary packages</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(zoo) <span class="co"># for linear interpolation of missing values</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the tsibble</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>fallriver_ts0 <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"https://byuistats.github.io/timeseries/data/fallriver.parquet"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ymd_hm</span>(datetime)) <span class="sc">|&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(datetime, date, flow) <span class="sc">|&gt;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dates =</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(<span class="fu">year</span>(date), <span class="st">"/"</span>, <span class="fu">month</span>(date), <span class="st">"/"</span>, <span class="fu">day</span>(date)))) <span class="sc">|&gt;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dates) <span class="sc">|&gt;</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">flow =</span> <span class="fu">mean</span>(flow), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> dates) <span class="sc">|&gt;</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill_gaps</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.zoo</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># impute missing values by interpolation</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.approx</span>(<span class="at">xout =</span> <span class="fu">seq</span>(<span class="fu">start</span>(.), <span class="fu">end</span>(.), <span class="st">"day"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fortify.zoo</span>() <span class="sc">|&gt;</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="st">"."</span>, </span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">dates =</span> Index</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">round_day =</span> <span class="fu">ifelse</span>(<span class="fu">day</span>(dates) <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">|&gt;</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dates2 =</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(<span class="fu">year</span>(dates), <span class="st">"/"</span>, <span class="fu">month</span>(dates), <span class="st">"/"</span>, round_day))) <span class="sc">|&gt;</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dates2) <span class="sc">|&gt;</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">flow =</span> <span class="fu">mean</span>(flow)) <span class="sc">|&gt;</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dates =</span> dates2) <span class="sc">|&gt;</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> dates, <span class="at">regular =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">dates</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">flow</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1998-10-01</td>
<td style="text-align: center; min-width: 0in;">634.682</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">1998-10-16</td>
<td style="text-align: center; min-width: 0in;">596.352</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">1998-11-01</td>
<td style="text-align: center; min-width: 0in;">578.583</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">1998-11-16</td>
<td style="text-align: center; min-width: 0in;">590.703</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2023-08-01</td>
<td style="text-align: center; min-width: 0in;">751.708</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">2023-08-16</td>
<td style="text-align: center; min-width: 0in;">634.236</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2023-09-01</td>
<td style="text-align: center; min-width: 0in;">625.772</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">2023-09-16</td>
<td style="text-align: center; min-width: 0in;">584.168</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fallriver_ts <span class="ot">&lt;-</span> fallriver_ts0 <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute additional variables needed for the regression</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TIME =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos1 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos2 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos3 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos4 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos5 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos6 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos7 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">7</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos8 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">8</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos9 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">9</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos10 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">10</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos11 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">11</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cos12 =</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">12</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin1 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin2 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin3 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin4 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin5 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin6 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin7 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">7</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin8 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">8</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin9 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">9</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin10 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">10</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sin11 =</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">11</span> <span class="sc">*</span> TIME <span class="sc">/</span> <span class="dv">24</span>),</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sin12 = sin(2 * pi * 12 * TIME / 24) # zero for all integer values of t</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the time series</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>fallriver_ts <span class="sc">|&gt;</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">.vars =</span> flow) <span class="sc">+</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Flow (cubic feet per second, cfs)"</span>,</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Fall River Flow Rate"</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Above the Yellowstone Canal near Squirrel, Idaho"</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter_5_lesson_3_files/figure-html/fallriver4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- Check Your Understanding -->
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="Check Your Understanding">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Understanding
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use the Fall River flow data to do the following.</p>
<ul>
<li>Explore various linear models for the flow of the Fall River over time.</li>
<li>Choose a model to represent the data, and justify your decision.</li>
</ul>
</div>
</div>
</section>
<section id="homework-preview-5-min" class="level2">
<h2 class="anchored" data-anchor-id="homework-preview-5-min">Homework Preview (5 min)</h2>
<ul>
<li>Review upcoming homework assignment</li>
<li>Clarify questions</li>
</ul>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Download Homework
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://byuistats.github.io/timeseries/homework/homework_5_3.qmd" download="homework_5_3.qmd"> homework_5_3.qmd </a></p>
</div>
</div>
<p><a href="javascript:showhide('Solutions1')" style="font-size:.8em;">Small-Group Activity</a></p>
<div id="Solutions1" style="display:none;">
<p>Here are the coefficients for two possible models that could be fitted to the Fall River flow data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>river_full_lm <span class="ot">&lt;-</span> fallriver_ts <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">river_full_lm  =</span> <span class="fu">TSLM</span>(flow <span class="sc">~</span> TIME </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin5 <span class="sc">+</span> cos5 <span class="sc">+</span> sin6 <span class="sc">+</span> cos6 </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin7 <span class="sc">+</span> cos7 <span class="sc">+</span> sin8 <span class="sc">+</span> cos8</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin9 <span class="sc">+</span> cos9 <span class="sc">+</span> sin10 <span class="sc">+</span> cos10</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin11 <span class="sc">+</span> cos11       <span class="sc">+</span> cos12</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>river_full_lm <span class="sc">|&gt;</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 7
   .model        term         estimate std.error statistic   p.value sig  
   &lt;chr&gt;         &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 river_full_lm (Intercept)  841.       24.8       33.9   1.82e-139 TRUE 
 2 river_full_lm TIME          -0.0267    0.0715    -0.373 7.09e-  1 FALSE
 3 river_full_lm sin1        -581.       17.5      -33.2   6.56e-136 TRUE 
 4 river_full_lm cos1        -130.       17.5       -7.46  3.30e- 13 TRUE 
 5 river_full_lm sin2         308.       17.5       17.6   6.27e- 56 TRUE 
 6 river_full_lm cos2        -307.       17.5      -17.5   1.92e- 55 TRUE 
 7 river_full_lm sin3          90.8      17.5        5.19  2.94e-  7 TRUE 
 8 river_full_lm cos3         250.       17.5       14.3   7.36e- 40 TRUE 
 9 river_full_lm sin4        -146.       17.5       -8.35  5.29e- 16 TRUE 
10 river_full_lm cos4         -25.6      17.5       -1.46  1.44e-  1 FALSE
# ℹ 15 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>river_reduced1_lm <span class="ot">&lt;-</span> fallriver_ts <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">river_reduced1_lm  =</span> <span class="fu">TSLM</span>(flow <span class="sc">~</span> TIME </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin1 <span class="sc">+</span> cos1 <span class="sc">+</span> sin2 <span class="sc">+</span> cos2 </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin3 <span class="sc">+</span> cos3 <span class="sc">+</span> sin4 <span class="sc">+</span> cos4 </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">+</span> sin5 <span class="sc">+</span> cos5</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>river_reduced1_lm <span class="sc">|&gt;</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 7
   .model            term         estimate std.error statistic   p.value sig  
   &lt;chr&gt;             &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;
 1 river_reduced1_lm (Intercept)  841.       24.6       34.2   5.32e-142 TRUE 
 2 river_reduced1_lm TIME          -0.0264    0.0709    -0.373 7.09e-  1 FALSE
 3 river_reduced1_lm sin1        -581.       17.4      -33.5   2.24e-138 TRUE 
 4 river_reduced1_lm cos1        -130.       17.4       -7.51  2.14e- 13 TRUE 
 5 river_reduced1_lm sin2         308.       17.4       17.8   7.47e- 57 TRUE 
 6 river_reduced1_lm cos2        -307.       17.4      -17.7   2.34e- 56 TRUE 
 7 river_reduced1_lm sin3          90.8      17.4        5.23  2.36e-  7 TRUE 
 8 river_reduced1_lm cos3         250.       17.4       14.4   1.70e- 40 TRUE 
 9 river_reduced1_lm sin4        -146.       17.4       -8.41  3.09e- 16 TRUE 
10 river_reduced1_lm cos4         -25.6      17.4       -1.47  1.41e-  1 FALSE
11 river_reduced1_lm sin5          40.0      17.4        2.31  2.15e-  2 TRUE 
12 river_reduced1_lm cos5         -66.8      17.4       -3.85  1.33e-  4 TRUE </code></pre>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter_5_lesson_2.html" class="pagination-link" aria-label="Harmonic Seasonal Variables - Part 1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Harmonic Seasonal Variables - Part 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter_5_lesson_4.html" class="pagination-link" aria-label="Transformations and Non-Linear Models">
        <span class="nav-page-text">Transformations and Non-Linear Models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>